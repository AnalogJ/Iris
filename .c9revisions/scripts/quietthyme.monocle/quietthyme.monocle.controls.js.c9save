{"ts":1355683375795,"silentsave":true,"restoring":false,"patch":[[]],"length":0}
{"contributors":[],"silentsave":false,"ts":1355683416322,"patch":[[{"diffs":[[1,"/* SPINNER */\r\nfunction controlSpinner(reader) {\r\n  var spinner = Monocle.Controls.Spinner(reader);\r\n  reader.addControl(spinner, 'page', { hidden: true });\r\n  spinner.listenForUsualDelays();\r\n}\r\n\r\n\r\nfunction controlContents(reader) {\r\n  var tocMenu = Monocle.Controls.Contents(reader);\r\n  reader.addControl(tocMenu, 'popover', { hidden: true });\r\n\r\n  var tocButton = {}\r\n  tocButton.createControlElements = function () {\r\n    var btn = document.createElement('div');\r\n    btn.className = \"tocButton\";\r\n    Monocle.Events.listen(\r\n      btn,\r\n      typeof Touch == \"object\" ? \"touchstart\" : \"mousedown\",\r\n      function (evt) {\r\n        if (evt.preventDefault) {\r\n          evt.stopPropagation();\r\n          evt.preventDefault();\r\n        } else {\r\n          evt.returnValue = false;\r\n        }\r\n        var menuDiv = reader.dom.find('controls_contents_container');\r\n        // Really really ugly code for animation effect. Don't copy this.\r\n        if (typeof(WebKitCSSMatrix) == \"object\") {\r\n          menuDiv.style.visibility = 'hidden';\r\n          reader.showControl(tocMenu);\r\n          menuDiv.style.webkitTransition = \"\";\r\n          menuDiv.style.webkitTransform = \"translateX(-100%)\";\r\n          setTimeout(\r\n            function () {\r\n              menuDiv.style.visibility = 'visible';\r\n              menuDiv.style.webkitTransition = \"-webkit-transform 300ms linear\";\r\n              menuDiv.style.webkitTransform = \"translateX(0px)\";\r\n            },\r\n            10\r\n          );\r\n        } else {\r\n          reader.showControl(tocMenu);\r\n        }\r\n      }\r\n    );\r\n    return btn;\r\n  }\r\n  reader.addControl(tocButton);\r\n  return tocButton;\r\n}\r\n\r\n\r\nfunction newBookTitle(reader) {\r\n  var bookTitle = {}\r\n  bookTitle.createControlElements = function () {\r\n    var cntr = document.createElement('div');\r\n    cntr.className = \"bookTitle\";\r\n    var btText = document.createElement('span');\r\n    btText.innerHTML = reader.getBook().getMetaData('title');\r\n    cntr.appendChild(btText);\r\n    this.chapText = document.createElement('span');\r\n    btText.appendChild(this.chapText);\r\n    this.update();\r\n    return cntr;\r\n  }\r\n  bookTitle.update = function () {\r\n    var place = reader.getPlace();\r\n    var t = place.chapterTitle();\r\n    if (t) {\r\n      this.chapText.innerHTML = \" &#8212; \" + t;\r\n    } else {\r\n      this.chapText.innerHTML = \"\";\r\n    }\r\n  }\r\n\r\n  reader.addControl(bookTitle);\r\n  reader.listen('monocle:turn', function () { bookTitle.update() });\r\n  return bookTitle;\r\n}\r\n\r\n\r\nfunction newBookPageNumber() {\r\n  var pageNumber = {\r\n    runners: [],\r\n    createControlElements: function (page) {\r\n      var cntr = document.createElement('div');\r\n      cntr.className = \"pageNumber\";\r\n      var runner = document.createElement('div');\r\n      runner.className = \"runner\";\r\n      cntr.appendChild(runner);\r\n      this.runners.push(runner);\r\n      this.update(page);\r\n      return cntr;\r\n    },\r\n    update: function (page) {\r\n      var place = reader.getPlace(page);\r\n      if (place) {\r\n        this.runners[page.m.pageIndex].innerHTML = place.pageNumber();\r\n      }\r\n    }\r\n  }\r\n  reader.addControl(pageNumber, 'page');\r\n  reader.listen(\r\n    'monocle:pagechange',\r\n    function (evt) { pageNumber.update(evt.m.page) }\r\n  );\r\n  return pageNumber;\r\n}"]],"start1":0,"start2":0,"length1":0,"length2":3264}]],"length":3264,"saved":false}
{"ts":1355683447177,"patch":[[{"diffs":[[0,"unction "],[-1,"newBook"],[1,"control"],[0,"Title(re"]],"start1":1661,"start2":1661,"length1":23,"length2":23}]],"length":3264,"saved":false}
{"ts":1355683466549,"patch":[[{"diffs":[[0,"ion "],[-1,"newBook"],[1,"control"],[0,"Page"]],"start1":2500,"start2":2500,"length1":15,"length2":15}]],"length":3264,"saved":false}
{"ts":1355684028822,"patch":[[{"diffs":[[0,"eNumber("],[1,"reader"],[0,") {\r\n  v"]],"start1":2514,"start2":2514,"length1":16,"length2":22}]],"length":3270,"saved":false}
