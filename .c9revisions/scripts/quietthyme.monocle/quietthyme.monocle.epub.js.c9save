{"ts":1355612731747,"silentsave":true,"restoring":false,"patch":[[]],"length":0}
{"contributors":[],"silentsave":false,"ts":1355612736839,"patch":[[{"diffs":[[1,"// @reference jszip.js\r\n\r\nvar QT = QT || {};\r\n\r\nQT.bookdata = (function(qt){\r\n    \r\n    //////////////////////////////////////////////////////////////////////////\r\n    // Private Data\r\n    //////////////////////////////////////////////////////////////////////////\r\n    var EVENT_LOADING = 'EVENT_LOADING';\r\n    \r\n    var MSG = {};\r\n    MSG.LOADING_FILE = 'Loading file from url';\r\n    MSG.UNZIPPING = 'Unzipping';\r\n    MSG.UNCOMPRESSING = 'Uncompressing file: ';\r\n    MSG.READING_OPF = 'Reading OPF';\r\n    MSG.POST_PROCESSING = 'Post processing';\r\n    MSG.FINISHED = 'Finished!';\r\n    \r\n    MSG.ERR_NOT_ZIP = 'File is not a proper Zip file';\r\n    MSG.ERR_BLANK_URL = 'Zip url cannot be blank';\r\n    \r\n    var STATE = {};\r\n    STATE.OK = 1;\r\n    STATE.ERR = 2;\r\n    \r\n    var unzipper;\r\n    var compressedFiles;\r\n    var files = {};\r\n    var opfPath;\r\n    var container;\r\n    //////////////////////////////////////////////////////////////////////////\r\n    // Private Methods\r\n    //////////////////////////////////////////////////////////////////////////\r\n    /**\r\n     * Determines if browser is a version of IE that supports ActiveXObjects.\r\n     */ \r\n    function useMSXHR() {\r\n        return typeof ActiveXObject == \"function\";\r\n    }\r\n    /**\r\n     * Retrieves the epub file from url,\r\n     * @param {String} url The url for the epub file.\r\n     * @param {Function} callback The callback that is executed once the epub file has been retrieved.\r\n     */ \r\n    function getBinaryFile(url, callback) {\r\n        var request = useMSXHR() ? new ActiveXObject(\"Msxml2.XmlHttp.6.0\")\r\n\t\t\t\t: new XMLHttpRequest();\r\n\t\trequest.onreadystatechange = function() {\r\n\t\t\tif (request.readyState == 1) {\r\n\t\t\t\tif (request.overrideMimeType) {\r\n\t\t\t\t\trequest\r\n\t\t\t\t\t\t\t.overrideMimeType('text/plain; charset=x-user-defined');\r\n\t\t\t\t}\r\n\t\t\t\trequest.send();\r\n\t\t\t}\r\n\r\n\t\t\tif (request.readyState == 4) {\r\n\t\t\t\tif (request.status == 200) {\r\n\t\t\t\t\tvar data;\r\n\t\t\t\t\tif (useMSXHR()) {\r\n\t\t\t\t\t\tvar data = new VBArray(request.responseBody).toArray();\r\n\t\t\t\t\t\tfor ( var j = 0; j < data.length; ++j)\r\n\t\t\t\t\t\t\tdata[j] = String.fromCharCode(data[j]);\r\n\t\t\t\t\t\tcallback(data.join(''));\r\n\t\t\t\t\t\trequest.abort();\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tcallback(request.responseText);\r\n\t\t\t\t\t}\r\n\t\t\t\t} else {\r\n\t\t\t\t\tconsole.log('Failed to get file ' + url + '<br>');\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\trequest.open(\"GET\", url, true);\r\n\t}\r\n    \r\n    /**\r\n     * Retrieves the epub file from url, then begins the process of parsing it by retrievig the container.xml file.\r\n     * @param {data} data contained inside the epub file.\r\n     */\r\n    function unzipBlob(data) {\r\n        try{\r\n            publish(EVENT_LOADING, STATE.OK,MSG.UNZIPPING);\r\n            unzipper = new JSZip();\r\n            unzipper.load(data, {\r\n                base64 : false\r\n            });\r\n            \r\n            console.log(unzipper);\r\n            console.log(unzipper.files);\r\n            compressedFiles= unzipper.files;\r\n            uncompressNextCompressedFile()\r\n            \r\n        }\r\n        catch(ex){\r\n            publish(EVENT_LOADING, STATE.ERR,MSG.ERR_NOT_ZIP);\r\n        }\r\n\t}\r\n    \r\n    function uncompressNextCompressedFile() {\r\n        var compressedFile = compressedFiles.shift();\r\n        if (compressedFile) {\r\n            publish(EVENT_LOADING, STATE.OK, MSG.UNCOMPRESSING + compressedFile.name);\r\n            uncompressFile(compressedFile);\r\n            withTimeout(uncompressNextCompressedFile);\r\n        } else {\r\n            didUncompressAllFiles();\r\n        }\r\n    };\r\n        \r\n    // For mockability\r\n    function withTimeout(func) {\r\n        var self = this;\r\n        setTimeout(function () {\r\n            func.call(self);\r\n        }, 30);\r\n    };\r\n\r\n    function didUncompressAllFiles() {\r\n            publish(EVENT_LOADING, STATE.OK, MSG.READING_OPF);\r\n            opfPath = getOpfPathFromContainer();\r\n            readOpf(files[opfPath]);\r\n\r\n            publish(EVENT_LOADING, STATE.OK, MSG.POST_PROCESSING);\r\n            postProcess();\r\n            publish(EVENT_LOADING, STATE.OK, MSG.FINISHED);\r\n        },\r\n\r\n    function uncompressFile(compressedFile) {\r\n        var data = compressedFile.data;\r\n\r\n        if (compressedFile.name === \"META-INF/container.xml\") {\r\n            this.container = data;\r\n        } else if (compressedFile.fileName === \"mimetype\") {\r\n            this.mimetype = data;\r\n        } else {\r\n            this.files[compressedFile.fileName] = data;\r\n        }\r\n    }\r\n    \r\n    \r\n    \r\n    //////////////////////////////////////////////////////////////////////////\r\n    // Public Methods\r\n    //////////////////////////////////////////////////////////////////////////\r\n    var init = function(url, options){\r\n        \r\n        if(url){\r\n            publish(EVENT_LOADING, STATE.OK,MSG.LOADING_FILE);\r\n            getBinaryFile(url,unzipBlob);\r\n            \r\n        }\r\n        else{\r\n            publish(EVENT_LOADING, STATE.ERR,MSG.ERR_BLANK_URL);\r\n        }\r\n        \r\n        \r\n    };\r\n    \r\n    //////////////////////////////////////////////////////////////////////////\r\n    // Messaging Methods\r\n    //////////////////////////////////////////////////////////////////////////\r\n    \r\n    function publish(event, state, message){\r\n        $(window).trigger(event, [state, message]);\r\n    }\r\n    function subscribe(selector, event, handler){\r\n        $(selector).bind(event, handler);\r\n    }\r\n    \r\n    \r\n    //////////////////////////////////////////////////////////////////////////\r\n    // Monocle Book Data Interface Methods \r\n    // https://github.com/joseph/Monocle/wiki/Book-data-object\r\n    //////////////////////////////////////////////////////////////////////////\r\n    \r\n    var getComponents = function () {\r\n    \r\n    }\r\n    var getContents = function () {\r\n       \r\n    }\r\n    var getComponent = function (componentId) {\r\n    \r\n    }\r\n    var getMetaData = function(key) {\r\n    \r\n    }\r\n    \r\n    return {\r\n        init : init,\r\n        \r\n        /*Monocle Book Data Interface Methods*/\r\n        getComponents : getComponents,\r\n        getContents : getContents,\r\n        getComponent : getComponent,\r\n        getMetaData : getMetaData\r\n    }\r\n        \r\n    \r\n})(QT)\r\n\r\n\r\n"]],"start1":0,"start2":0,"length1":0,"length2":6138}]],"length":6138,"saved":false}
{"ts":1355613001236,"patch":[[{"diffs":[[0,"sedFile."],[-1,"fileN"],[1,"n"],[0,"ame === "]],"start1":4257,"start2":4257,"length1":21,"length2":17},{"diffs":[[0,"ile."],[-1,"fileN"],[1,"n"],[0,"ame]"]],"start1":4376,"start2":4376,"length1":13,"length2":9}]],"length":6130,"saved":false}
{"ts":1355613012996,"patch":[[{"diffs":[[0,"container;\r\n"],[1,"    var mimetype;\r\n"],[0,"    ////////"]],"start1":859,"start2":859,"length1":24,"length2":43}]],"length":6149,"saved":false}
{"ts":1355613026428,"patch":[[{"diffs":[[0,"        "],[-1,"this."],[1,"var "],[0,"containe"]],"start1":4218,"start2":4218,"length1":21,"length2":20},{"diffs":[[0,"        "],[-1,"this."],[0,"mimetype"]],"start1":4311,"start2":4311,"length1":21,"length2":16}]],"length":6143,"saved":false}
{"ts":1355613029553,"patch":[[{"diffs":[[0,"            "],[-1,"var "],[0,"container = "]],"start1":4214,"start2":4214,"length1":28,"length2":24}]],"length":6139,"saved":false}
{"ts":1355613034038,"patch":[[{"diffs":[[0,"    "],[-1,"this."],[0,"file"]],"start1":4359,"start2":4359,"length1":13,"length2":8}]],"length":6134,"saved":false}
{"ts":1355613125002,"patch":[[{"diffs":[[0," }\r\n    \r\n    \r\n"],[1,"    function getOpfPathFromContainer() {\r\n            var doc = this.xmlDocument(this.container);\r\n            return doc\r\n                .getElementsByTagName(\"rootfile\")[0]\r\n                .getAttribute(\"full-path\");\r\n        },\r\n\r\n        readOpf: function (xml) {\r\n            var doc = this.xmlDocument(xml);\r\n            \r\n            var opf = {\r\n                metadata: {},\r\n                manifest: {},\r\n                spine: []\r\n            };\r\n\r\n            var metadataNodes = doc\r\n                .getElementsByTagName(\"metadata\")[0]\r\n                .childNodes;\r\n\r\n            for (var i = 0, il = metadataNodes.length; i < il; i++) {\r\n                var node = metadataNodes[i];\r\n                // Skip text nodes (whitespace)\r\n                if (node.nodeType === 3) { continue }\r\n\r\n                var attrs = {};\r\n                for (var i2 = 0, il2 = node.attributes.length; i2 < il2; i2++) {\r\n                    var attr = node.attributes[i2];\r\n                    attrs[attr.name] = attr.value;\r\n                }\r\n                attrs._text = node.textContent;\r\n                opf.metadata[node.nodeName] = attrs;\r\n            }\r\n\r\n            var manifestEntries = doc\r\n                .getElementsByTagName(\"manifest\")[0]\r\n                .getElementsByTagName(\"item\");\r\n\r\n            for (var i = 0, il = manifestEntries.length; i < il; i++) {\r\n                var node = manifestEntries[i];\r\n\r\n                opf.manifest[node.getAttribute(\"id\")] = {\r\n                    \"href\": this.resolvePath(node.getAttribute(\"href\"), this.opfPath),\r\n                    \"media-type\": node.getAttribute(\"media-type\")\r\n                }\r\n            }\r\n\r\n            var spineEntries = doc\r\n                .getElementsByTagName(\"spine\")[0]\r\n                .getElementsByTagName(\"itemref\");\r\n\r\n            for (var i = 0, il = spineEntries.length; i < il; i++) {\r\n                var node = spineEntries[i];\r\n                opf.spine.push(node.getAttribute(\"idref\"));\r\n            }\r\n\r\n            this.opf = opf;\r\n        },\r\n\r\n        resolvePath: function (path, referrerLocation) {\r\n            var pathDirs = path.split(\"/\");\r\n            var fileName = pathDirs.pop();\r\n\r\n            var locationDirs = referrerLocation.split(\"/\");\r\n            locationDirs.pop();\r\n\r\n            for (var i = 0, il = pathDirs.length; i < il; i++) {\r\n                var spec = pathDirs[i];\r\n                if (spec === \"..\") {\r\n                    locationDirs.pop();\r\n                } else {\r\n                    locationDirs.push(spec);\r\n                }\r\n            }\r\n\r\n            locationDirs.push(fileName);\r\n            return locationDirs.join(\"/\");\r\n        },\r\n\r\n        findMediaTypeByHref: function (href) {\r\n            for (key in this.opf.manifest) {\r\n                var item = this.opf.manifest[key];\r\n                if (item[\"href\"] === href) {\r\n                    return item[\"media-type\"];\r\n                }\r\n            }\r\n\r\n            // Best guess if it's not in the manifest. (Those bastards.)\r\n            var match = href.match(/\\.(\\w+)$/);\r\n            return match && \"image/\" + match[1];\r\n        },\r\n\r\n        // Will modify all HTML and CSS files in place.\r\n        postProcess: function () {\r\n            for (var key in this.opf.manifest) {\r\n                var mediaType = this.opf.manifest[key][\"media-type\"]\r\n                var href = this.opf.manifest[key][\"href\"]\r\n                var result;\r\n\r\n                if (mediaType === \"text/css\") {\r\n                    result = this.postProcessCSS(href);\r\n                } else if (mediaType === \"application/xhtml+xml\") {\r\n                    result = this.postProcessHTML(href);\r\n                }\r\n\r\n                if (result !== undefined) {\r\n                    this.files[href] = result;\r\n                }\r\n            }\r\n        },\r\n    \r\n"],[0,"    \r\n    //////"]],"start1":4413,"start2":4413,"length1":32,"length2":3896}]],"length":9998,"saved":false}
{"ts":1355613132972,"patch":[[{"diffs":[[0,"er() {\r\n        "],[-1,"    "],[0,"var doc = this.x"]],"start1":4463,"start2":4463,"length1":36,"length2":32},{"diffs":[[0,"      var doc = "],[-1,"this."],[0,"xmlDocument(this"]],"start1":4473,"start2":4473,"length1":37,"length2":32}]],"length":9989,"saved":false}
{"ts":1355613135280,"patch":[[{"diffs":[[0,"ocument("],[-1,"this."],[0,"containe"]],"start1":4493,"start2":4493,"length1":21,"length2":16}]],"length":9984,"saved":false}
{"ts":1355613144691,"patch":[[{"diffs":[[0,");\r\n        "],[-1,"    "],[0,"return doc\r\n"]],"start1":4510,"start2":4510,"length1":28,"length2":24},{"diffs":[[0,"return doc\r\n"],[-1,"    "],[0,"            "]],"start1":4522,"start2":4522,"length1":28,"length2":24},{"diffs":[[0,"            "],[-1," "],[-1,"   "],[0,".getAttribut"]],"start1":4584,"start2":4584,"length1":28,"length2":24},{"diffs":[[0,"ll-path\");\r\n    "],[-1,"    },"],[1,"}"],[0,"\r\n\r\n        read"]],"start1":4613,"start2":4613,"length1":38,"length2":33}]],"length":9967,"saved":false}
{"ts":1355613179094,"patch":[[{"diffs":[[0,"\n   "],[-1,"     readOpf:"],[0," fun"]],"start1":4633,"start2":4633,"length1":21,"length2":8},{"diffs":[[0,"unction "],[1,"readOpf"],[0,"(xml) {\r"]],"start1":4639,"start2":4639,"length1":16,"length2":23},{"diffs":[[0,"Opf(xml) {\r\n"],[-1,"    "],[0,"        var "]],"start1":4651,"start2":4651,"length1":28,"length2":24},{"diffs":[[0,"r doc = "],[-1,"this."],[0,"xmlDocum"]],"start1":4673,"start2":4673,"length1":21,"length2":16},{"diffs":[[0,"  \r\n        "],[-1,"    "],[0,"var opf = {\r"]],"start1":4710,"start2":4710,"length1":28,"length2":24},{"diffs":[[0,"ar opf = {\r\n"],[-1,"    "],[0,"            "]],"start1":4723,"start2":4723,"length1":28,"length2":24},{"diffs":[[0,"        "],[-1,"    "],[0,"manifest"]],"start1":4766,"start2":4766,"length1":20,"length2":16},{"diffs":[[0,"        "],[-1,"    "],[0,"spine: ["]],"start1":4793,"start2":4793,"length1":20,"length2":16},{"diffs":[[0,"ne: []\r\n"],[-1,"    "],[0,"        "]],"start1":4804,"start2":4804,"length1":20,"length2":16}]],"length":9932,"saved":false}
{"ts":1355613209838,"patch":[[{"diffs":[[0,"\r\n\r\n        "],[-1,"    "],[0,"var metadata"]],"start1":4822,"start2":4822,"length1":28,"length2":24},{"diffs":[[0,"ataNodes = doc\r\n"],[-1,"    "],[0,"            .get"]],"start1":4843,"start2":4843,"length1":36,"length2":32},{"diffs":[[0,"        "],[-1,"    "],[0,".childNo"]],"start1":4913,"start2":4913,"length1":20,"length2":16},{"diffs":[[0,"des;\r\n\r\n        "],[-1," "],[-1,"   "],[0,"for (var i = 0, "]],"start1":4929,"start2":4929,"length1":36,"length2":32},{"diffs":[[0," {\r\n            "],[-1,"   "],[-1," "],[0,"var node = metad"]],"start1":5000,"start2":5000,"length1":36,"length2":32},{"diffs":[[0,"adataNodes[i];\r\n"],[-1,"    "],[0,"            // S"]],"start1":5030,"start2":5030,"length1":36,"length2":32},{"diffs":[[0,"            "],[-1," "],[-1,"   "],[0,"if (node.nod"]],"start1":5091,"start2":5091,"length1":28,"length2":24},{"diffs":[[0,"ntinue }\r\n\r\n"],[-1,"    "],[0,"            "]],"start1":5132,"start2":5132,"length1":28,"length2":24},{"diffs":[[0,"};\r\n            "],[-1,"    "],[0,"for (var i2 = 0,"]],"start1":5169,"start2":5169,"length1":36,"length2":32},{"diffs":[[0,"                "],[-1,"  "],[-1,"  "],[0,"var attr = node."]],"start1":5251,"start2":5251,"length1":36,"length2":32},{"diffs":[[0,"butes[i2];\r\n"],[-1,"    "],[0,"            "]],"start1":5288,"start2":5288,"length1":28,"length2":24},{"diffs":[[0,"e;\r\n            "],[-1,"    "],[0,"}\r\n             "]],"start1":5344,"start2":5344,"length1":36,"length2":32},{"diffs":[[0,"            "],[-1,"  "],[-1,"  "],[0,"attrs._text "]],"start1":5363,"start2":5363,"length1":28,"length2":24},{"diffs":[[0,"xtContent;\r\n"],[-1,"    "],[0,"            "]],"start1":5396,"start2":5396,"length1":28,"length2":24},{"diffs":[[0,"attrs;\r\n        "],[-1,"    "],[0,"}\r\n\r\n           "]],"start1":5450,"start2":5450,"length1":36,"length2":32},{"diffs":[[0,"\r\n\r\n        "],[-1,"   "],[-1," "],[0,"var manifest"]],"start1":5467,"start2":5467,"length1":28,"length2":24},{"diffs":[[0,"tEntries = doc\r\n"],[-1,"    "],[0,"            .get"]],"start1":5490,"start2":5490,"length1":36,"length2":32},{"diffs":[[0,"0]\r\n            "],[-1," "],[-1,"   "],[0,".getElementsByTa"]],"start1":5552,"start2":5552,"length1":36,"length2":32},{"diffs":[[0,"m\");\r\n\r\n        "],[-1,"   "],[-1," "],[0,"for (var i = 0, "]],"start1":5594,"start2":5594,"length1":36,"length2":32},{"diffs":[[0," {\r\n            "],[-1,"    "],[0,"var node = manif"]],"start1":5667,"start2":5667,"length1":36,"length2":32},{"diffs":[[0,"            "],[-1,"  "],[-1,"  "],[0,"opf.manifest"]],"start1":5717,"start2":5717,"length1":28,"length2":24},{"diffs":[[0,"\"id\")] = {\r\n"],[-1,"    "],[0,"            "]],"start1":5760,"start2":5760,"length1":28,"length2":24},{"diffs":[[0,"        "],[-1,"    "],[0,"\"media-t"]],"start1":5864,"start2":5864,"length1":20,"length2":16},{"diffs":[[0,"            "],[-1,"    }\r\n    "],[1,"}\r\n"],[0,"        }\r\n\r"]],"start1":5919,"start2":5919,"length1":35,"length2":27}]],"length":9832,"saved":false}
{"ts":1355613226727,"patch":[[{"diffs":[[0,"\r\n\r\n        "],[-1,"    "],[0,"var spineEnt"]],"start1":5943,"start2":5943,"length1":28,"length2":24},{"diffs":[[0,"eEntries = doc\r\n"],[-1,"    "],[0,"            .get"]],"start1":5963,"start2":5963,"length1":36,"length2":32},{"diffs":[[0,"0]\r\n            "],[-1,"   "],[-1," "],[0,".getElementsByTa"]],"start1":6022,"start2":6022,"length1":36,"length2":32},{"diffs":[[0,"emref\");\r\n\r\n"],[-1,"    "],[0,"        for "]],"start1":6063,"start2":6063,"length1":28,"length2":24},{"diffs":[[0," {\r\n            "],[-1,"    "],[0,"var node = spine"]],"start1":6137,"start2":6137,"length1":36,"length2":32},{"diffs":[[0,"            "],[-1," "],[-1,"   "],[0,"opf.spine.pu"]],"start1":6182,"start2":6182,"length1":28,"length2":24},{"diffs":[[0,"ef\"));\r\n        "],[-1,"    "],[0,"}\r\n\r\n           "]],"start1":6231,"start2":6231,"length1":36,"length2":32},{"diffs":[[0,"        "],[-1,"    this."],[0,"opf = op"]],"start1":6252,"start2":6252,"length1":25,"length2":16},{"diffs":[[0,"= opf;\r\n    "],[-1,"    },"],[1,"}"],[0,"\r\n\r\n        "]],"start1":6264,"start2":6264,"length1":30,"length2":25}]],"length":9790,"saved":false}
{"ts":1355613244357,"patch":[[{"diffs":[[0," mimetype;\r\n"],[1,"    var opf;\r\n"],[0,"    ////////"]],"start1":878,"start2":878,"length1":24,"length2":38}]],"length":9804,"saved":false}
{"ts":1355613264991,"patch":[[{"diffs":[[0,"    var "],[1,"_"],[0,"unzipper"]],"start1":767,"start2":767,"length1":16,"length2":17},{"diffs":[[0,"ipper;\r\n    var "],[1,"_"],[0,"compressedFiles;"]],"start1":779,"start2":779,"length1":32,"length2":33},{"diffs":[[0,"s;\r\n    var "],[1,"_"],[0,"files = {};\r"]],"start1":810,"start2":810,"length1":24,"length2":25},{"diffs":[[0,"    var "],[1,"_"],[0,"opfPath;"]],"start1":836,"start2":836,"length1":16,"length2":17},{"diffs":[[0,"    var "],[1,"_"],[0,"containe"]],"start1":855,"start2":855,"length1":16,"length2":17},{"diffs":[[0,"    var "],[1,"_"],[0,"mimetype"]],"start1":876,"start2":876,"length1":16,"length2":17},{"diffs":[[0,"    var "],[1,"_"],[0,"opf;\r\n  "]],"start1":896,"start2":896,"length1":16,"length2":17}]],"length":9811,"saved":false}
{"ts":1355613471017,"patch":[[{"diffs":[[0,");\r\n            "],[1,"_"],[0,"unzipper = new J"]],"start1":2696,"start2":2696,"length1":32,"length2":33},{"diffs":[[0,"        "],[1,"_"],[0,"unzipper"]],"start1":2742,"start2":2742,"length1":16,"length2":17},{"diffs":[[0,"    console.log("],[1,"_"],[0,"unzipper);\r\n    "]],"start1":2845,"start2":2845,"length1":32,"length2":33},{"diffs":[[0,"ole.log("],[1,"_"],[0,"unzipper"]],"start1":2890,"start2":2890,"length1":16,"length2":17},{"diffs":[[0,"dFiles= "],[1,"_"],[0,"unzipper"]],"start1":2938,"start2":2938,"length1":16,"length2":17},{"diffs":[[0,"        "],[1,"_"],[0,"opfPath "]],"start1":3828,"start2":3828,"length1":16,"length2":17},{"diffs":[[0,"readOpf("],[1,"_"],[0,"files["],[1,"_"],[0,"opfPath]"]],"start1":3887,"start2":3887,"length1":22,"length2":24},{"diffs":[[0,"        "],[-1,""],[0,""],[1,"_"],[0,"containe"]],"start1":4247,"start2":4247,"length1":16,"length2":17},{"diffs":[[0,"        "],[1,"_"],[0,"mimetype"]],"start1":4337,"start2":4337,"length1":16,"length2":17},{"diffs":[[0,"        "],[1,"_"],[0,"files[co"]],"start1":4386,"start2":4386,"length1":16,"length2":17},{"diffs":[[0,"ocument("],[-1,""],[0,""],[1,"_"],[0,"containe"]],"start1":4525,"start2":4525,"length1":16,"length2":17},{"diffs":[[0,"        "],[1,"_"],[0,"opf = op"]],"start1":6285,"start2":6285,"length1":16,"length2":17},{"diffs":[[0,"   }\r\n\r\n    "],[-1,"   "],[1,"function"],[0," resolvePath"]],"start1":6307,"start2":6307,"length1":27,"length2":32},{"diffs":[[0,"olvePath"],[-1,": function "],[0,"(path, r"]],"start1":6331,"start2":6331,"length1":27,"length2":16},{"diffs":[[0,"ocation) {\r\n"],[-1,"    "],[0,"        var "]],"start1":6355,"start2":6355,"length1":28,"length2":24},{"diffs":[[0,");\r\n        "],[-1," "],[-1,"   "],[0,"var fileName"]],"start1":6404,"start2":6404,"length1":28,"length2":24},{"diffs":[[0,"\r\n\r\n        "],[-1,"  "],[-1,"  "],[0,"var location"]],"start1":6446,"start2":6446,"length1":28,"length2":24},{"diffs":[[0,"(\"/\");\r\n        "],[-1,"    "],[0,"locationDirs.pop"]],"start1":6499,"start2":6499,"length1":36,"length2":32},{"diffs":[[0,"s.pop();\r\n\r\n"],[-1,"    "],[0,"        for "]],"start1":6526,"start2":6526,"length1":28,"length2":24},{"diffs":[[0,"            "],[-1,"    "],[0,"var spec = p"]],"start1":6600,"start2":6600,"length1":28,"length2":24},{"diffs":[[0,"            "],[-1,"    "],[0,"if (spec ==="]],"start1":6637,"start2":6637,"length1":28,"length2":24},{"diffs":[[0,"                "],[-1,"   "],[-1," "],[0,"locationDirs.pop"]],"start1":6671,"start2":6671,"length1":36,"length2":32},{"diffs":[[0,"irs.pop();\r\n"],[-1,"    "],[0,"            "]],"start1":6696,"start2":6696,"length1":28,"length2":24},{"diffs":[[0,"                "],[-1,"    "],[0,"locationDirs.pus"]],"start1":6730,"start2":6730,"length1":36,"length2":32},{"diffs":[[0,"    "],[-1," "],[-1,"   }\r\n   "],[1,"}\r\n"],[0,"        "],[-1," "],[0,"}\r\n\r\n"],[-1,"    "],[0,"    "]],"start1":6780,"start2":6780,"length1":36,"length2":24},{"diffs":[[0,");\r\n        "],[-1,"    "],[0,"return locat"]],"start1":6834,"start2":6834,"length1":28,"length2":24},{"diffs":[[0,"join(\"/\");\r\n    "],[-1,"    },"],[1,"};"],[0,"\r\n\r\n        find"]],"start1":6866,"start2":6866,"length1":38,"length2":34}]],"length":9758,"saved":false}
{"ts":1355613479110,"patch":[[{"diffs":[[0,"\r\n\r\n    "],[-1,"   "],[1,"function"],[0," findMed"]],"start1":6884,"start2":6884,"length1":19,"length2":24},{"diffs":[[0,"peByHref"],[-1,": function "],[0,"(href) {"]],"start1":6912,"start2":6912,"length1":27,"length2":16}]],"length":9752,"saved":false}
{"ts":1355613496074,"patch":[[{"diffs":[[0," {\r\n        "],[-1,"    "],[0,"for (key in "]],"start1":6926,"start2":6926,"length1":28,"length2":24},{"diffs":[[0,"pf.manifest) {\r\n"],[-1,"    "],[0,"            var "]],"start1":6956,"start2":6956,"length1":36,"length2":32},{"diffs":[[0,"            "],[-1,"   "],[-1," "],[0,"if (item[\"hr"]],"start1":7020,"start2":7020,"length1":28,"length2":24},{"diffs":[[0,"== href) {\r\n"],[-1,"    "],[0,"            "]],"start1":7050,"start2":7050,"length1":28,"length2":24},{"diffs":[[0,"];\r\n            "],[-1,"    "],[0,"}\r\n            }"]],"start1":7102,"start2":7102,"length1":36,"length2":32},{"diffs":[[0," }\r\n        "],[-1," "],[-1,"   "],[0,"}\r\n\r\n"],[-1,"    "],[0,"        // B"]],"start1":7117,"start2":7117,"length1":37,"length2":29},{"diffs":[[0,".)\r\n        "],[-1,"   "],[-1," "],[0,"var match = "]],"start1":7200,"start2":7200,"length1":28,"length2":24},{"diffs":[[0,".(\\w+)$/);\r\n"],[-1,"    "],[0,"        retu"]],"start1":7237,"start2":7237,"length1":28,"length2":24},{"diffs":[[0,"ch[1];\r\n    "],[-1,"    },"],[1,"}"],[0,"\r\n\r\n        "]],"start1":7287,"start2":7287,"length1":30,"length2":25}]],"length":9711,"saved":false}
{"ts":1355613498939,"patch":[[{"diffs":[[0,"   for ("],[1,"var "],[0,"key in t"]],"start1":6935,"start2":6935,"length1":16,"length2":20}]],"length":9715,"saved":false}
{"ts":1355613513267,"patch":[[{"diffs":[[0,"place.\r\n    "],[-1,"   "],[1,"function"],[0," postProcess"]],"start1":7357,"start2":7357,"length1":27,"length2":32},{"diffs":[[0,"cess"],[-1,": function "],[0,"() {"]],"start1":7385,"start2":7385,"length1":19,"length2":8}]],"length":9709,"saved":false}
{"ts":1355613530231,"patch":[[{"diffs":[[0,"ss() {\r\n        "],[-1,"    "],[0,"for (var key in "]],"start1":7387,"start2":7387,"length1":36,"length2":32},{"diffs":[[0,"pf.manifest) {\r\n"],[-1,"    "],[0,"            var "]],"start1":7425,"start2":7425,"length1":36,"length2":32},{"diffs":[[0,"            "],[-1,"    "],[0,"var href = t"]],"start1":7507,"start2":7507,"length1":28,"length2":24},{"diffs":[[0,"            "],[-1,"   "],[-1," "],[0,"var result;\r"]],"start1":7562,"start2":7562,"length1":28,"length2":24},{"diffs":[[0," result;\r\n\r\n"],[-1,"    "],[0,"            "]],"start1":7577,"start2":7577,"length1":28,"length2":24},{"diffs":[[0,"                "],[-1,"  "],[-1,"  "],[0,"result = this.po"]],"start1":7634,"start2":7634,"length1":36,"length2":32},{"diffs":[[0,"cessCSS(href);\r\n"],[-1,"    "],[0,"            } el"]],"start1":7671,"start2":7671,"length1":36,"length2":32},{"diffs":[[0,"                "],[-1," "],[-1,"   "],[0,"result = this.po"]],"start1":7752,"start2":7752,"length1":36,"length2":32},{"diffs":[[0,"essHTML(href);\r\n"],[-1,"    "],[0,"            }\r\n\r"]],"start1":7790,"start2":7790,"length1":36,"length2":32},{"diffs":[[0,"            "],[-1,"    "],[0,"if (result !"]],"start1":7823,"start2":7823,"length1":28,"length2":24},{"diffs":[[0,"        "],[-1,"   "],[-1," "],[0,"this.fil"]],"start1":7872,"start2":7872,"length1":20,"length2":16},{"diffs":[[0,"    "],[-1,"    }\r\n   "],[1,"}\r\n"],[0,"        "],[-1," "],[0,"}\r\n    "],[-1,"    },"],[1,"}"],[0,"\r\n  "]],"start1":7916,"start2":7916,"length1":40,"length2":27}]],"length":9652,"saved":false}
{"ts":1355613545587,"patch":[[{"diffs":[[0,"for (var key in "],[-1,"this."],[1,"_"],[0,"opf.manifest) {\r"]],"start1":6938,"start2":6938,"length1":37,"length2":33},{"diffs":[[0," item = "],[-1,"this."],[1,"_"],[0,"opf.mani"]],"start1":6987,"start2":6987,"length1":21,"length2":17}]],"length":9644,"saved":false}
{"ts":1355613563560,"patch":[[{"diffs":[[0," key in "],[-1,"this."],[1,"_"],[0,"opf.mani"]],"start1":7403,"start2":7403,"length1":21,"length2":17},{"diffs":[[0,"aType = "],[-1,"this."],[1,"_"],[0,"opf.mani"]],"start1":7449,"start2":7449,"length1":21,"length2":17}]],"length":9636,"saved":false}
{"ts":1355613568131,"patch":[[{"diffs":[[0," href = "],[-1,"this."],[1,"_"],[0,"opf.mani"]],"start1":7506,"start2":7506,"length1":21,"length2":17}]],"length":9632,"saved":false}
{"ts":1355613574389,"patch":[[{"diffs":[[0,"       result = "],[-1,"this."],[0,"postProcessCSS(h"]],"start1":7623,"start2":7623,"length1":37,"length2":32}]],"length":9627,"saved":false}
{"ts":1355613577452,"patch":[[{"diffs":[[0,"esult = "],[-1,"this."],[0,"postProc"]],"start1":7744,"start2":7744,"length1":21,"length2":16}]],"length":9622,"saved":false}
{"ts":1355613580910,"patch":[[{"diffs":[[0,"        "],[-1,"this."],[1,"_"],[0,"files[hr"]],"start1":7842,"start2":7842,"length1":21,"length2":17}]],"length":9618,"saved":false}
{"ts":1355613612909,"patch":[[{"diffs":[[0," }\r\n    \r\n    \r\n"],[1,"    function postProcessCSS(href) {\r\n            var file = this.files[href];\r\n            var self = this;\r\n\r\n            file = file.replace(/url\\((.*?)\\)/gi, function (str, url) {\r\n                if (/^data/i.test(url)) {\r\n                    // Don't replace data strings\r\n                    return str;\r\n                } else {\r\n                    var dataUri = self.getDataUri(url, href);\r\n                    return \"url(\" + dataUri + \")\";\r\n                }\r\n            });\r\n\r\n            return file;\r\n        },\r\n\r\n        postProcessHTML: function (href) {\r\n            var xml = decodeURIComponent(escape(this.files[href]));\r\n            var doc = this.xmlDocument(xml);\r\n\r\n            var images = doc.getElementsByTagName(\"img\");\r\n            for (var i = 0, il = images.length; i < il; i++) {\r\n                var image = images[i];\r\n                var src = image.getAttribute(\"src\");\r\n                if (/^data/.test(src)) { continue }\r\n                image.setAttribute(\"src\", this.getDataUri(src, href))\r\n            }\r\n\r\n            var head = doc.getElementsByTagName(\"head\")[0];\r\n            var links = head.getElementsByTagName(\"link\");\r\n            for (var i = 0, il = links.length; i < il; i++) {\r\n                var link = links[0];\r\n                if (link.getAttribute(\"type\") === \"text/css\") {\r\n                    var inlineStyle = document.createElement(\"style\");\r\n                    inlineStyle.setAttribute(\"type\", \"text/css\");\r\n                    inlineStyle.setAttribute(\"data-orig-href\", link.getAttribute(\"href\"));\r\n\r\n                    var css = this.files[this.resolvePath(link.getAttribute(\"href\"), href)];\r\n                    inlineStyle.appendChild(document.createTextNode(css));\r\n\r\n                    head.replaceChild(inlineStyle, link);\r\n                }\r\n            }\r\n\r\n            return doc;\r\n        },\r\n\r\n        getDataUri: function (url, href) {\r\n            var dataHref = this.resolvePath(url, href);\r\n            var mediaType = this.findMediaTypeByHref(dataHref);\r\n            var encodedData = escape(this.files[dataHref]);\r\n            return \"data:\" + mediaType + \",\" + encodedData;\r\n        },\r\n\r\n        validate: function () {\r\n            if (this.container === undefined) {\r\n                throw new Error(\"META-INF/container.xml file not found.\");\r\n            }\r\n\r\n            if (this.mimetype === undefined) {\r\n                throw new Error(\"Mimetype file not found.\");\r\n            }\r\n\r\n            if (this.mimetype !== \"application/epub+zip\") {\r\n                throw new Error(\"Incorrect mimetype \" + this.mimetype);\r\n            }\r\n        },\r\n\r\n        // for data URIs\r\n        escapeData: function (data) {\r\n            return escape(data);\r\n        },\r\n\r\n        xmlDocument: function (xml) {\r\n            var doc = new DOMParser().parseFromString(xml, \"text/xml\");\r\n\r\n            if (doc.childNodes[1] && doc.childNodes[1].nodeName === \"parsererror\") {\r\n                throw doc.childNodes[1].childNodes[0].nodeValue;\r\n            }\r\n\r\n            return doc;\r\n        }\r\n    \r\n    \r\n"],[0,"    ////////////"]],"start1":7903,"start2":7903,"length1":32,"length2":3118}]],"length":12704,"saved":false}
{"ts":1355613616633,"patch":[[{"diffs":[[0," file = "],[-1,"this."],[1,"_"],[0,"files[hr"]],"start1":7971,"start2":7971,"length1":21,"length2":17}]],"length":12700,"saved":false}
{"ts":1355613654068,"patch":[[{"diffs":[[0," {\r\n        "],[-1,"    "],[0,"var file = _"]],"start1":7952,"start2":7952,"length1":28,"length2":24},{"diffs":[[0,"];\r\n        "],[-1,"    "],[0,"var self = t"]],"start1":7986,"start2":7986,"length1":28,"length2":24},{"diffs":[[0," = this;\r\n\r\n"],[-1,"    "],[0,"        file"]],"start1":8006,"start2":8006,"length1":28,"length2":24},{"diffs":[[0," {\r\n            "],[-1,"  "],[-1,"  "],[0,"if (/^data/i.tes"]],"start1":8083,"start2":8083,"length1":36,"length2":32},{"diffs":[[0,"st(url)) {\r\n"],[-1,"    "],[0,"            "]],"start1":8114,"start2":8114,"length1":28,"length2":24},{"diffs":[[0,"            "],[-1,"    "],[0,"return str;\r"]],"start1":8177,"start2":8177,"length1":28,"length2":24},{"diffs":[[0,"r;\r\n            "],[-1,"   "],[-1," "],[0,"} else {\r\n      "]],"start1":8198,"start2":8198,"length1":36,"length2":32},{"diffs":[[0,"      } else {\r\n"],[-1,"    "],[0,"                "]],"start1":8208,"start2":8208,"length1":36,"length2":32},{"diffs":[[0,"                "],[-1,"    "],[0,"return \"url(\" + "]],"start1":8283,"start2":8283,"length1":36,"length2":32},{"diffs":[[0,"+ \")\";\r\n"],[-1,"    "],[0,"        "]],"start1":8323,"start2":8323,"length1":20,"length2":16},{"diffs":[[0,"    "],[-1,"    "],[0,"});\r\n\r\n"],[-1,"    "],[0,"    "]],"start1":8350,"start2":8350,"length1":23,"length2":15},{"diffs":[[0," file;\r\n    "],[-1,"    },"],[1,"}"],[0,"\r\n\r\n        "]],"start1":8375,"start2":8375,"length1":30,"length2":25}]],"length":12647,"saved":false}
{"ts":1355613703948,"patch":[[{"diffs":[[0,"   }\r\n\r\n    "],[-1,"   "],[1,"function"],[0," postProcess"]],"start1":8384,"start2":8384,"length1":27,"length2":32},{"diffs":[[0,"cessHTML"],[-1,": function "],[0,"(href) {"]],"start1":8412,"start2":8412,"length1":27,"length2":16},{"diffs":[[0," {\r\n        "],[-1,"    "],[0,"var xml = de"]],"start1":8426,"start2":8426,"length1":28,"length2":24},{"diffs":[[0,"ef]));\r\n        "],[-1,"    "],[0,"var doc = this.x"]],"start1":8487,"start2":8487,"length1":36,"length2":32},{"diffs":[[0,"r doc = "],[-1,"this."],[0,"xmlDocum"]],"start1":8505,"start2":8505,"length1":21,"length2":16},{"diffs":[[0,"nt(xml);\r\n\r\n"],[-1,"    "],[0,"        var "]],"start1":8522,"start2":8522,"length1":28,"length2":24},{"diffs":[[0,"me(\"img\");\r\n"],[-1,"    "],[0,"        for "]],"start1":8577,"start2":8577,"length1":28,"length2":24}]],"length":12620,"saved":false}
{"ts":1355613717787,"patch":[[{"diffs":[[0,"            "],[-1,"    "],[0,"var image = "]],"start1":8649,"start2":8649,"length1":28,"length2":24},{"diffs":[[0,"e = images[i];\r\n"],[-1,"    "],[0,"            var "]],"start1":8669,"start2":8669,"length1":36,"length2":32},{"diffs":[[0,");\r\n            "],[-1,"  "],[-1,"  "],[0,"if (/^data/.test"]],"start1":8731,"start2":8731,"length1":36,"length2":32},{"diffs":[[0,"continue }\r\n"],[-1,"    "],[0,"            "]],"start1":8772,"start2":8772,"length1":28,"length2":24},{"diffs":[[0,"href))\r\n"],[-1,"    "],[0,"        "]],"start1":8843,"start2":8843,"length1":20,"length2":16}]],"length":12600,"saved":false}
{"ts":1355613736352,"patch":[[{"diffs":[[0,"\r\n\r\n        "],[-1,"    "],[0,"var head = d"]],"start1":8860,"start2":8860,"length1":28,"length2":24},{"diffs":[[0,"head\")[0];\r\n"],[-1,"    "],[0,"        var "]],"start1":8909,"start2":8909,"length1":28,"length2":24},{"diffs":[[0,"ink\");\r\n        "],[-1,"    "],[0,"for (var i = 0, "]],"start1":8969,"start2":8969,"length1":36,"length2":32},{"diffs":[[0,"i < il; i++) {\r\n"],[-1,"    "],[0,"            var "]],"start1":9020,"start2":9020,"length1":36,"length2":32},{"diffs":[[0,"            "],[-1,"    "],[0,"if (link.get"]],"start1":9070,"start2":9070,"length1":28,"length2":24},{"diffs":[[0," \"text/css\") {\r\n"],[-1,"    "],[0,"                "]],"start1":9115,"start2":9115,"length1":36,"length2":32},{"diffs":[[0,"                "],[-1,"    "],[0,"inlineStyle.setA"]],"start1":9199,"start2":9199,"length1":36,"length2":32},{"diffs":[[0,"                "],[-1,"   "],[-1," "],[0,"inlineStyle.setA"]],"start1":9262,"start2":9262,"length1":36,"length2":32},{"diffs":[[0,"href\"));\r\n\r\n"],[-1,"    "],[0,"            "]],"start1":9340,"start2":9340,"length1":28,"length2":24},{"diffs":[[0,"                "],[-1,"   "],[-1," "],[0,"inlineStyle.appe"]],"start1":9442,"start2":9442,"length1":36,"length2":32},{"diffs":[[0,"        "],[-1,"    "],[0,"head.rep"]],"start1":9524,"start2":9524,"length1":20,"length2":16},{"diffs":[[0,"            "],[-1,"  "],[-1,"  "],[0,"}\r\n"],[-1,"    "],[0,"        }\r\n\r"]],"start1":9571,"start2":9571,"length1":35,"length2":27},{"diffs":[[0,"   }\r\n\r\n        "],[-1,"  "],[-1,"  "],[0,"return doc;\r\n   "]],"start1":9591,"start2":9591,"length1":36,"length2":32},{"diffs":[[0,"n doc;\r\n    "],[-1,"    },"],[1,"}"],[0,"\r\n\r\n        "]],"start1":9612,"start2":9612,"length1":30,"length2":25}]],"length":12539,"saved":false}
{"ts":1355613771367,"patch":[[{"diffs":[[0,"nent(escape("],[-1,"this."],[1,"_"],[0,"files[href])"]],"start1":8462,"start2":8462,"length1":29,"length2":25},{"diffs":[[0,"(\"src\", "],[-1,"this."],[0,"getDataU"]],"start1":8810,"start2":8810,"length1":21,"length2":16},{"diffs":[[0,"s = "],[-1,"this."],[1,"_"],[0,"files["],[-1,"this."],[0,"reso"]],"start1":9365,"start2":9365,"length1":24,"length2":15},{"diffs":[[0,"   }\r\n\r\n    "],[-1,"   "],[1,"function"],[0," getDataUri:"]],"start1":9603,"start2":9603,"length1":27,"length2":32},{"diffs":[[0,"tDataUri"],[-1,": function "],[0,"(url, hr"]],"start1":9626,"start2":9626,"length1":27,"length2":16},{"diffs":[[0,"ref) {\r\n        "],[-1,"    "],[0,"var dataHref = t"]],"start1":9641,"start2":9641,"length1":36,"length2":32},{"diffs":[[0,"th(url, href);\r\n"],[-1,"    "],[0,"        var medi"]],"start1":9686,"start2":9686,"length1":36,"length2":32},{"diffs":[[0,");\r\n        "],[-1,"   "],[-1," "],[0,"var encodedD"]],"start1":9759,"start2":9759,"length1":28,"length2":24},{"diffs":[[0,"ataHref]);\r\n"],[-1,"    "],[0,"        retu"]],"start1":9808,"start2":9808,"length1":28,"length2":24},{"diffs":[[0,"dData;\r\n    "],[-1,"    },"],[1,"}"],[0,"\r\n\r\n        "]],"start1":9869,"start2":9869,"length1":30,"length2":25}]],"length":12494,"saved":false}
{"ts":1355613780530,"patch":[[{"diffs":[[0,"aHref = "],[-1,"this."],[0,"resolveP"]],"start1":9664,"start2":9664,"length1":21,"length2":16},{"diffs":[[0,"aType = "],[-1,"this."],[0,"findMedi"]],"start1":9713,"start2":9713,"length1":21,"length2":16},{"diffs":[[0," escape("],[-1,"this."],[1,"_"],[0,"files[da"]],"start1":9778,"start2":9778,"length1":21,"length2":17}]],"length":12480,"saved":false}
{"ts":1355613853635,"patch":[[{"diffs":[[0,"\r\n\r\n    "],[-1,"   "],[1,"function"],[0," validat"]],"start1":9868,"start2":9868,"length1":19,"length2":24},{"diffs":[[0,"validate"],[-1,": function "],[0,"() {\r\n  "]],"start1":9885,"start2":9885,"length1":27,"length2":16},{"diffs":[[0,"        "],[-1,"    if (this."],[1,"if (_"],[0,"containe"]],"start1":9899,"start2":9899,"length1":29,"length2":21},{"diffs":[[0,"= undefined) {\r\n"],[-1," "],[0,"               t"]],"start1":9924,"start2":9924,"length1":33,"length2":32},{"diffs":[[0,");\r\n        "],[-1,"    "],[0,"}\r\n\r\n"],[-1,"    "],[0,"        if ("]],"start1":10011,"start2":10011,"length1":37,"length2":29},{"diffs":[[0,"\r\n\r\n        if ("],[-1,"this."],[1,"_"],[0,"mimetype === und"]],"start1":10024,"start2":10024,"length1":37,"length2":33},{"diffs":[[0,"= undefined) {\r\n"],[-1,"    "],[0,"            thro"]],"start1":10052,"start2":10052,"length1":36,"length2":32},{"diffs":[[0,"nd.\");\r\n        "],[-1,"    "],[0,"}\r\n\r\n           "]],"start1":10118,"start2":10118,"length1":36,"length2":32},{"diffs":[[0,"    "],[-1," "],[-1,"   "],[0,"if ("],[-1,"this."],[1,"_"],[0,"mime"]],"start1":10143,"start2":10143,"length1":21,"length2":13},{"diffs":[[0,"ub+zip\") {\r\n"],[-1,"    "],[0,"            "]],"start1":10180,"start2":10180,"length1":28,"length2":24},{"diffs":[[0,"ype \" + "],[-1,"this."],[1,"_"],[0,"mimetype"]],"start1":10236,"start2":10236,"length1":21,"length2":17},{"diffs":[[0,"    "],[-1,"    "],[0,"}\r\n    "],[-1,"  "],[-1,"  },"],[1,"}"],[0,"\r\n\r\n"]],"start1":10261,"start2":10261,"length1":25,"length2":16},{"diffs":[[0,"Is\r\n    "],[-1,"   "],[1,"function"],[0," escapeD"]],"start1":10299,"start2":10299,"length1":19,"length2":24},{"diffs":[[0,"capeData"],[-1,": function "],[0,"(data) {"]],"start1":10318,"start2":10318,"length1":27,"length2":16},{"diffs":[[0,"ta(data) {\r\n"],[-1,"    "],[0,"        retu"]],"start1":10324,"start2":10324,"length1":28,"length2":24},{"diffs":[[0,"    "],[-1," "],[-1,"   },"],[1,"}"],[0,"\r\n\r\n    "],[-1,"   "],[1,"function"],[0," xml"]],"start1":10366,"start2":10366,"length1":25,"length2":25},{"diffs":[[0,"ment"],[-1,": function "],[0,"(xml"]],"start1":10395,"start2":10395,"length1":19,"length2":8},{"diffs":[[0,"ent(xml) {\r\n"],[-1,"    "],[0,"        var "]],"start1":10396,"start2":10396,"length1":28,"length2":24},{"diffs":[[0,"\r\n\r\n        "],[-1,"    "],[0,"if (doc.chil"]],"start1":10475,"start2":10475,"length1":28,"length2":24},{"diffs":[[0,"            "],[-1,"    "],[0,"throw doc.ch"]],"start1":10561,"start2":10561,"length1":28,"length2":24},{"diffs":[[0,"e;\r\n        "],[-1,"  "],[-1,"  "],[0,"}\r\n\r\n"],[-1,"    "],[0,"        retu"]],"start1":10619,"start2":10619,"length1":37,"length2":29},{"diffs":[[0,"n doc;\r\n"],[-1,"    "],[0,"    }\r\n "]],"start1":10649,"start2":10649,"length1":20,"length2":16}]],"length":12375,"saved":false}
{"ts":1355613930385,"patch":[[{"diffs":[[0,"        "],[1,"_"],[0,"compress"]],"start1":2921,"start2":2921,"length1":16,"length2":17},{"diffs":[[0,"dFile = "],[1,"_"],[0,"compress"]],"start1":3207,"start2":3207,"length1":16,"length2":17},{"diffs":[[0,"pe === 3) { "],[-1,"continue"],[1,"\r\n                continue; \r\n           "],[0," }\r\n\r\n      "]],"start1":5153,"start2":5153,"length1":32,"length2":65}]],"length":12410,"saved":false}
{"ts":1355614016523,"patch":[[{"diffs":[[0,"\"href\": "],[-1,"this."],[0,"resolveP"]],"start1":5856,"start2":5856,"length1":21,"length2":16},{"diffs":[[0,"\"), "],[-1,"this."],[1,"_"],[0,"opfP"]],"start1":5899,"start2":5899,"length1":13,"length2":9},{"diffs":[[0,"oin(\"/\");\r\n    }"],[-1,";"],[0,"\r\n\r\n    function"]],"start1":6893,"start2":6893,"length1":33,"length2":32},{"diffs":[[0,"src)) { "],[-1,"continue"],[1,"\r\n                continue;\r\n           "],[0," }\r\n    "]],"start1":8785,"start2":8785,"length1":24,"length2":56}]],"length":12432,"saved":false}
{"ts":1355614121379,"patch":[[{"diffs":[[0,");\r\n    "],[-1,"    },"],[1,"}"],[0,"\r\n\r\n    "]],"start1":4072,"start2":4072,"length1":22,"length2":17}]],"length":12427,"saved":false}
{"ts":1355614199066,"patch":[[{"diffs":[[0,"nit,\r\n        \r\n"],[1,"        unzipper = function(){return _unzipper;}\r\n    var _compressedFiles;\r\n    var _files = {};\r\n    var _opfPath;\r\n    var _container;\r\n    var _mimetype;\r\n    var _opf;\r\n        \r\n"],[0,"        /*Monocl"]],"start1":12178,"start2":12178,"length1":32,"length2":216}]],"length":12611,"saved":false}
{"ts":1355614253030,"patch":[[{"diffs":[[0,"it :"],[1," "],[0," init,\r\n"],[-1,""],[0,"    "]],"start1":12172,"start2":12172,"length1":16,"length2":17},{"diffs":[[0,"unzipper"],[1,":         "],[0," "],[-1,"="],[0," functio"]],"start1":12203,"start2":12203,"length1":18,"length2":27},{"diffs":[[0,"zipper;}"],[1,","],[0,"\r\n    "],[-1,"var"],[1,"    compressedFiles:    function(){return"],[0," _compre"]],"start1":12244,"start2":12244,"length1":25,"length2":64},{"diffs":[[0,"ressedFiles;"],[1,"},"],[0,"\r\n    "],[1," "],[-1,"var"],[1,"   files:              function(){return"],[0," _files = {}"]],"start1":12306,"start2":12306,"length1":33,"length2":73},{"diffs":[[0,"urn _files = {};"],[1,"},"],[0,"\r\n    var _opfPa"]],"start1":12364,"start2":12364,"length1":32,"length2":34}]],"length":12702,"saved":false}
{"ts":1355614288624,"patch":[[{"diffs":[[0,"n _files"],[-1," = {}"],[0,";},\r\n   "]],"start1":12366,"start2":12366,"length1":21,"length2":16},{"diffs":[[0,"les;},\r\n    "],[-1,"var"],[1,"    opfPath:            function(){return"],[0," _opfPath;\r\n"]],"start1":12371,"start2":12371,"length1":27,"length2":65},{"diffs":[[0,"return _opfPath;"],[1,"},"],[0,"\r\n    var _conta"]],"start1":12418,"start2":12418,"length1":32,"length2":34}]],"length":12737,"saved":false}
{"ts":1355614320670,"patch":[[{"diffs":[[0,"ath;},\r\n    "],[-1,"var"],[1,"    container:          function(){return"],[0," _container;"]],"start1":12430,"start2":12430,"length1":27,"length2":65},{"diffs":[[0," _container;"],[1,"},"],[0,"\r\n    "],[1," "],[-1,"var"],[1,"   _mimetype:          function(){return"],[0," _mimetype;\r"]],"start1":12483,"start2":12483,"length1":33,"length2":73},{"diffs":[[0,"eturn _mimetype;"],[1,"}"],[0,"\r\n    var _opf;\r"]],"start1":12539,"start2":12539,"length1":32,"length2":33}]],"length":12816,"saved":false}
{"ts":1355614340522,"patch":[[{"diffs":[[0,"ner;},\r\n        "],[-1,"_"],[0,"mimetype:       "]],"start1":12491,"start2":12491,"length1":33,"length2":32},{"diffs":[[0,"metype;}"],[1,","],[0,"\r\n    "],[-1,"var"],[1,"    opf:               function(){return"],[0," _opf;"],[1,"},"],[0,"\r\n      "]],"start1":12547,"start2":12547,"length1":31,"length2":71}]],"length":12855,"saved":false}
{"ts":1355614345950,"patch":[[{"diffs":[[0,"etype:          "],[1," "],[0,"function(){retur"]],"start1":12510,"start2":12510,"length1":32,"length2":33},{"diffs":[[0,"    opf:"],[1," "],[0,"        "]],"start1":12563,"start2":12563,"length1":16,"length2":17}]],"length":12857,"saved":false}
{"ts":1355614406427,"patch":[[{"diffs":[[0,"inished!';\r\n"],[1,"    MSG.FINISHED_POST_PROCESSING = 'FINISHED_POST_PROCESSING';\r\n"],[0,"    \r\n    MS"]],"start1":569,"start2":569,"length1":24,"length2":88}]],"length":12921,"saved":false}
{"ts":1355614465630,"patch":[[{"diffs":[[0,"  }\r\n        }\r\n"],[1,"        publish(EVENT_LOADING,STATE.OK,MSG.FINISHED_POST_PROCESSING);\r\n"],[0,"    }\r\n    \r\n   "]],"start1":7968,"start2":7968,"length1":32,"length2":103}]],"length":12992,"saved":false}
{"ts":1355614493183,"patch":[[{"diffs":[[0,"_LOADING';\r\n    "],[1,"var EVENT_READY = 'EVENT_BOOKDATA_READY';"],[0,"\r\n    var MSG = "]],"start1":295,"start2":295,"length1":32,"length2":73}]],"length":13033,"saved":false}
{"ts":1355614497883,"patch":[[{"diffs":[[0,"r EVENT_"],[1,"BOOKDATA_"],[0,"READY = "]],"start1":313,"start2":313,"length1":16,"length2":25}]],"length":13042,"saved":false}
{"ts":1355614543541,"patch":[[{"diffs":[[0,"OCESSING);\r\n"],[1,"        publish(EVENT_BOOKDATA_READY, this);\r\n"],[0,"    }\r\n    \r"]],"start1":8093,"start2":8093,"length1":24,"length2":70}]],"length":13088,"saved":false}
{"ts":1355614655804,"patch":[[{"diffs":[[0,"//////////////\r\n"],[1,"    var EVENT ={};\r\n    EVENT.LOADING = 'EVENT_LOADING';\r\n    EVENT.BOOKDATA_READY\r\n    \r\n"],[0,"    var EVENT_LO"]],"start1":249,"start2":249,"length1":32,"length2":122}]],"length":13178,"saved":false}
{"ts":1355614660369,"patch":[[{"diffs":[[0,"TA_READY"],[1," = 'EVENT_BOOKDATA_READY';"],[0,"\r\n    \r\n"]],"start1":339,"start2":339,"length1":16,"length2":42}]],"length":13204,"saved":false}
{"ts":1355614699995,"patch":[[{"diffs":[[0,"   publish(EVENT"],[-1,"_"],[1,"."],[0,"LOADING, STATE.O"]],"start1":2878,"start2":2878,"length1":33,"length2":33},{"diffs":[[0,"   publish(EVENT"],[-1,"_"],[1,"."],[0,"LOADING, STATE.E"]],"start1":3293,"start2":3293,"length1":33,"length2":33},{"diffs":[[0,"   publish(EVENT"],[-1,"_"],[1,"."],[0,"LOADING, STATE.O"]],"start1":3512,"start2":3512,"length1":33,"length2":33},{"diffs":[[0,"   publish(EVENT"],[-1,"_"],[1,"."],[0,"LOADING, STATE.O"]],"start1":4001,"start2":4001,"length1":33,"length2":33},{"diffs":[[0,"   publish(EVENT"],[-1,"_"],[1,"."],[0,"LOADING, STATE.O"]],"start1":4158,"start2":4158,"length1":33,"length2":33},{"diffs":[[0,"   publish(EVENT"],[-1,"_"],[1,"."],[0,"LOADING, STATE.O"]],"start1":4254,"start2":4254,"length1":33,"length2":33}]],"length":13204,"saved":false}
{"ts":1355614712621,"patch":[[{"diffs":[[0,"   publish(EVENT"],[-1,"_"],[1,"."],[0,"LOADING,STATE.OK"]],"start1":8155,"start2":8155,"length1":33,"length2":33},{"diffs":[[0,"ublish(EVENT"],[-1,"_"],[1,"."],[0,"BOOKDATA_REA"]],"start1":8230,"start2":8230,"length1":25,"length2":25}]],"length":13204,"saved":false}
{"ts":1355614722643,"patch":[[{"diffs":[[0,"   publish(EVENT"],[-1,"_"],[1,"."],[0,"LOADING, STATE.O"]],"start1":11335,"start2":11335,"length1":33,"length2":33},{"diffs":[[0,"ublish(EVENT"],[-1,"_"],[1,"."],[0,"LOADING, STA"]],"start1":11486,"start2":11486,"length1":25,"length2":25}]],"length":13204,"saved":false}
{"ts":1355614734060,"patch":[[{"diffs":[[0,"    "],[-1,"var EVENT_LOADING = 'EVENT_LOADING';\r\n    var EVENT_BOOKDATA_READY = 'EVENT_BOOKDATA_READY';"],[0,"\r\n  "]],"start1":381,"start2":381,"length1":100,"length2":8}]],"length":13112,"saved":false}
{"ts":1355614774743,"patch":[[{"diffs":[[0,"t :  init,\r\n"],[1,"        events : function(){return EVENT;}\r\n"],[0,"        \r\n  "]],"start1":12428,"start2":12428,"length1":24,"length2":68}]],"length":13156,"saved":false}
{"ts":1355614785352,"patch":[[{"diffs":[[0," EVENT;}"],[1,","],[0,"\r\n      "]],"start1":12474,"start2":12474,"length1":16,"length2":17}]],"length":13157,"saved":false}
{"ts":1355615032859,"patch":[[{"diffs":[[0,"DY, this);\r\n"],[1,"        console.log(this);\r\n"],[0,"    }\r\n    \r"]],"start1":8163,"start2":8163,"length1":24,"length2":52}]],"length":13185,"saved":false}
{"ts":1355615093986,"patch":[[{"diffs":[[0,"catch(ex){\r\n"],[1,"            console.log(eg);\r\n"],[0,"            "]],"start1":3180,"start2":3180,"length1":24,"length2":54}]],"length":13215,"saved":false}
{"ts":1355615155581,"patch":[[{"diffs":[[0,"le.log(e"],[-1,"g"],[1,"x"],[0,");\r\n    "]],"start1":3209,"start2":3209,"length1":17,"length2":17}]],"length":13215,"saved":false}
{"ts":1355615193540,"patch":[[{"diffs":[[0,"        "],[1,"//"],[0,"try{\r\n  "]],"start1":2763,"start2":2763,"length1":16,"length2":18},{"diffs":[[0,"      \r\n        "],[1,"//"],[0,"}\r\n        catch"]],"start1":3155,"start2":3155,"length1":32,"length2":34},{"diffs":[[0,"        "],[1,"//"],[0,"catch(ex"]],"start1":3176,"start2":3176,"length1":16,"length2":18},{"diffs":[[0,"        "],[1,"//"],[0,"}\r\n\t}\r\n "]],"start1":3292,"start2":3292,"length1":16,"length2":18}]],"length":13223,"saved":false}
{"ts":1355615255296,"patch":[[{"diffs":[[0,"er.files"],[1,", typeof(_unzipper.files)"],[0,");\r\n    "]],"start1":3045,"start2":3045,"length1":16,"length2":41}]],"length":13248,"saved":false}
{"ts":1355615549782,"patch":[[{"diffs":[[0,"r.files));\r\n"],[1,"            \r\n"],[0,"            "]],"start1":3070,"start2":3070,"length1":24,"length2":38},{"diffs":[[0,"les="],[-1," _unzipper.files;"],[1,"[];\r\n            for(var key in _unzipper.files){\r\n                var item = _unzipper.files[key];\r\n                if(item){\r\n                    _compressedFiles.push(item);\r\n                }\r\n            }\r\n            "],[0,"\r\n  "]],"start1":3121,"start2":3121,"length1":25,"length2":232}]],"length":13469,"saved":false}
{"ts":1355615593221,"patch":[[{"diffs":[[0,"){\r\n            "],[1,"//"],[0,"console.log(ex);"]],"start1":3440,"start2":3440,"length1":32,"length2":34}]],"length":13471,"saved":false}
{"ts":1355615620092,"patch":[[{"diffs":[[0,"(event, "],[-1,"["],[0,"state, m"]],"start1":12069,"start2":12069,"length1":17,"length2":16},{"diffs":[[0," message"],[-1,"]"],[0,");\r\n    "]],"start1":12083,"start2":12083,"length1":17,"length2":16}]],"length":13469,"saved":false}
{"ts":1355615631937,"patch":[[{"diffs":[[0,".trigger(event, "],[1,"["],[0,"state, message);"]],"start1":12061,"start2":12061,"length1":32,"length2":33},{"diffs":[[0," message"],[1,"]"],[0,");\r\n    "]],"start1":12084,"start2":12084,"length1":16,"length2":17}]],"length":13471,"saved":false}
{"ts":1355615792502,"patch":[[{"diffs":[[0,"rn _opf;},\r\n"],[1,"        publish:    publish,\r\n"],[0,"        \r\n  "]],"start1":13216,"start2":13216,"length1":24,"length2":54}]],"length":13501,"saved":false}
{"ts":1355617677980,"patch":[[{"diffs":[[0," var _opf;\r\n"],[1,"    var _epubVersion;\r\n"],[0,"    ////////"]],"start1":1037,"start2":1037,"length1":24,"length2":47}]],"length":13524,"saved":false}
{"ts":1355617778225,"patch":[[{"diffs":[[0,"opf = opf;\r\n"],[1,"        \r\n        //Additions Dec 15, 2012\r\n        \r\n        \r\n"],[0,"    }\r\n\r\n   "]],"start1":6762,"start2":6762,"length1":24,"length2":88}]],"length":13588,"saved":false}
{"ts":1355617826460,"patch":[[{"diffs":[[0,", 2012\r\n        "],[1,"// Get the NCX\r\n        var opf_item_tag = 'opf\\\\:item';\r\n        var epub_version_tag = 'opf\\\\:package';\r\n    \r\n        if ($(f).find('opf\\\\:item').length == 0) {\r\n            opf_item_tag = 'item';\r\n            epub_version_tag = 'package';\r\n        }\r\n        \r\n        _epubversion = parseInt($('<div/>').append($(f)).find(epub_version_tag).attr('version'), 10);\r\n\t\r\n        $(f).find(opf_item_tag).each(\r\n\t\t\tfunction() {\r\n\t\t\t\t// Cheat and find the first file ending in NCX\r\n\t\t\t\t// modified to include ePub 3 support\r\n\t\t\t\tif ($(this).attr('href').indexOf('.ncx') != -1\r\n\t\t\t\t\t\t|| $(this).attr('id').toLowerCase() === 'toc') {\r\n\t\t\t\t\tif(oebps_dir){\r\n                        ncx_file = oebps_dir + '/' + $(this).attr('href');\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse{\r\n\t\t\t\t\t\tncx_file =  $(this).attr('href');\r\n\t\t\t\t\t}\r\n\t\t\t\t\t// jQuery.get(ncx_file, {}, toc);\r\n\t\t\t\t\t// console.log(ncx_file);\r\n\t\t\t\t\tgetDataFromEpub(ncx_file, function(response) {\r\n\t\t\t\t\t\ttoc(response);\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t});"],[0,"\r\n        \r\n    "]],"start1":6810,"start2":6810,"length1":32,"length2":997},{"diffs":[[0,"        \r\n    }\r"],[1,"\n    \r"],[0,"\n\r\n    function "]],"start1":7793,"start2":7793,"length1":32,"length2":38}]],"length":14559,"saved":false}
{"ts":1355618121467,"patch":[[{"diffs":[[0,"opf;\r\n        \r\n"],[1,"        \r\n        console.log(xml);\r\n//"],[0,"        //Additi"]],"start1":6768,"start2":6768,"length1":32,"length2":71},{"diffs":[[0,", 2012\r\n"],[1,"//"],[0,"        "]],"start1":6849,"start2":6849,"length1":16,"length2":18},{"diffs":[[0,"he NCX\r\n"],[1,"//"],[0,"        "]],"start1":6875,"start2":6875,"length1":16,"length2":18},{"diffs":[[0," 'opf\\\\:item';\r\n"],[1,"//"],[0,"        var epub"]],"start1":6911,"start2":6911,"length1":32,"length2":34},{"diffs":[[0,":package';\r\n"],[1,"//"],[0,"    \r\n"],[1,"//"],[0,"        if ("]],"start1":6966,"start2":6966,"length1":30,"length2":34},{"diffs":[[0,"th == 0) {\r\n"],[1,"//"],[0,"            "]],"start1":7028,"start2":7028,"length1":24,"length2":26},{"diffs":[[0," = 'item';\r\n"],[1,"//"],[0,"            "]],"start1":7066,"start2":7066,"length1":24,"length2":26},{"diffs":[[0,"'package';\r\n"],[1,"//"],[0,"        }\r\n "]],"start1":7111,"start2":7111,"length1":24,"length2":26},{"diffs":[[0,";\r\n//        }\r\n"],[1,"//"],[0,"        \r\n      "]],"start1":7120,"start2":7120,"length1":32,"length2":34},{"diffs":[[0," }\r\n//        \r\n"],[1,"//"],[0,"        _epubver"]],"start1":7132,"start2":7132,"length1":32,"length2":34},{"diffs":[[0,");\r\n"],[1,"//"],[0,"\t\r\n"],[1,"//"],[0,"    "]],"start1":7249,"start2":7249,"length1":11,"length2":15},{"diffs":[[0,".each(\r\n"],[1,"//"],[0,"\t\t\tfunct"]],"start1":7291,"start2":7291,"length1":16,"length2":18},{"diffs":[[0,"nction() {\r\n"],[1,"//"],[0,"\t\t\t\t// Cheat"]],"start1":7306,"start2":7306,"length1":24,"length2":26},{"diffs":[[0,"in NCX\r\n"],[1,"//"],[0,"\t\t\t\t// m"]],"start1":7364,"start2":7364,"length1":16,"length2":18},{"diffs":[[0,"upport\r\n"],[1,"//"],[0,"\t\t\t\tif ("]],"start1":7409,"start2":7409,"length1":16,"length2":18},{"diffs":[[0," != -1\r\n"],[1,"//"],[0,"\t\t\t\t\t\t||"]],"start1":7463,"start2":7463,"length1":16,"length2":18},{"diffs":[[0,"= 'toc') {\r\n"],[1,"//"],[0,"\t\t\t\t\tif(oebp"]],"start1":7517,"start2":7517,"length1":24,"length2":26},{"diffs":[[0,"ebps_dir){\r\n"],[1,"//"],[0,"            "]],"start1":7540,"start2":7540,"length1":24,"length2":26},{"diffs":[[0,"r('href');\r\n"],[1,"//"],[0,"\t\t\t\t\t}\r\n"],[1,"//"],[0,"\t\t\t\t\telse{\r\n"]],"start1":7618,"start2":7618,"length1":32,"length2":36},{"diffs":[[0,"\telse{\r\n"],[1,"//"],[0,"\t\t\t\t\t\tnc"]],"start1":7646,"start2":7646,"length1":16,"length2":18},{"diffs":[[0,"r('href');\r\n"],[1,"//"],[0,"\t\t\t\t\t}\r\n"],[1,"//"],[0,"\t\t\t\t\t// jQue"]],"start1":7685,"start2":7685,"length1":32,"length2":36},{"diffs":[[0," {}, toc);\r\n"],[1,"//"],[0,"\t\t\t\t\t// cons"]],"start1":7737,"start2":7737,"length1":24,"length2":26},{"diffs":[[0,"ncx_file);\r\n"],[1,"//"],[0,"\t\t\t\t\tgetData"]],"start1":7771,"start2":7771,"length1":24,"length2":26},{"diffs":[[0,"esponse) {\r\n"],[1,"//"],[0,"\t\t\t\t\t\ttoc(re"]],"start1":7826,"start2":7826,"length1":24,"length2":26},{"diffs":[[0,"response);\r\n"],[1,"//"],[0,"\t\t\t\t\t});\r\n\t\t"]],"start1":7850,"start2":7850,"length1":24,"length2":26},{"diffs":[[0,"\t\t\t});\r\n"],[1,"//"],[0,"\t\t\t\t}\r\n"],[1,"//"],[0,"\t\t});\r\n "]],"start1":7866,"start2":7866,"length1":23,"length2":27}]],"length":14658,"saved":false}
{"ts":1355618365892,"patch":[[{"diffs":[[0,"(xml);\r\n"],[-1,"//"],[0,"        "]],"start1":6813,"start2":6813,"length1":18,"length2":16},{"diffs":[[0,", 2012\r\n"],[-1,"//"],[0,"        "]],"start1":6847,"start2":6847,"length1":18,"length2":16},{"diffs":[[0,"he NCX\r\n"],[-1,"//"],[0,"        "]],"start1":6871,"start2":6871,"length1":18,"length2":16},{"diffs":[[0," = '"],[-1,"opf\\\\:"],[0,"item';\r\n"],[-1,"//"],[0,"    "]],"start1":6903,"start2":6903,"length1":24,"length2":16},{"diffs":[[0,"_tag = '"],[-1,"opf\\\\:"],[0,"package'"]],"start1":6939,"start2":6939,"length1":22,"length2":16},{"diffs":[[0,"';\r\n"],[-1,"//"],[0,"    \r\n"],[-1,"//"],[0,"    "]],"start1":6954,"start2":6954,"length1":18,"length2":14},{"diffs":[[0,"= 0) {\r\n"],[-1,"//"],[0,"        "]],"start1":7008,"start2":7008,"length1":18,"length2":16},{"diffs":[[0," = 'item';\r\n"],[-1,"//"],[0,"            "]],"start1":7040,"start2":7040,"length1":26,"length2":24},{"diffs":[[0,"kage';\r\n"],[-1,"//"],[0,"        "]],"start1":7087,"start2":7087,"length1":18,"length2":16},{"diffs":[[0,"     }\r\n"],[-1,"//"],[0,"        "]],"start1":7098,"start2":7098,"length1":18,"length2":16},{"diffs":[[0,"      \r\n"],[-1,"//"],[0,"        "]],"start1":7108,"start2":7108,"length1":18,"length2":16},{"diffs":[[0,");\r\n"],[-1,"//"],[0,"\t\r\n"],[-1,"//"],[0,"    "]],"start1":7215,"start2":7215,"length1":15,"length2":11},{"diffs":[[0,".each(\r\n"],[-1,"//"],[0,"\t\t\tfunct"]],"start1":7253,"start2":7253,"length1":18,"length2":16},{"diffs":[[0,"nction() {\r\n"],[-1,"//"],[0,"\t\t\t\t// Cheat"]],"start1":7266,"start2":7266,"length1":26,"length2":24},{"diffs":[[0,"in NCX\r\n"],[-1,"//"],[0,"\t\t\t\t// m"]],"start1":7322,"start2":7322,"length1":18,"length2":16},{"diffs":[[0,"upport\r\n"],[-1,"//"],[0,"\t\t\t\tif ("]],"start1":7365,"start2":7365,"length1":18,"length2":16},{"diffs":[[0," != -1\r\n"],[-1,"//"],[0,"\t\t\t\t\t\t||"]],"start1":7417,"start2":7417,"length1":18,"length2":16},{"diffs":[[0,"= 'toc') {\r\n"],[-1,"//"],[0,"\t\t\t\t\tif(oebp"]],"start1":7469,"start2":7469,"length1":26,"length2":24},{"diffs":[[0,"_dir){\r\n"],[-1,"//"],[0,"        "]],"start1":7494,"start2":7494,"length1":18,"length2":16},{"diffs":[[0,"r('href');\r\n"],[-1,"//"],[0,"\t\t\t\t\t}\r\n"],[-1,"//"],[0,"\t\t\t\t\telse{\r\n"]],"start1":7566,"start2":7566,"length1":36,"length2":32},{"diffs":[[0,"\telse{\r\n"],[-1,"//"],[0,"\t\t\t\t\t\tnc"]],"start1":7590,"start2":7590,"length1":18,"length2":16},{"diffs":[[0,");\r\n"],[-1,"//"],[0,"\t\t\t\t\t}\r\n"],[-1,"//"],[0,"\t\t\t\t"]],"start1":7635,"start2":7635,"length1":20,"length2":16},{"diffs":[[0," {}, toc);\r\n"],[-1,"//"],[0,"\t\t\t\t\t// cons"]],"start1":7675,"start2":7675,"length1":26,"length2":24},{"diffs":[[0,"ncx_file);\r\n"],[-1,"//"],[0,"\t\t\t\t\tgetData"]],"start1":7707,"start2":7707,"length1":26,"length2":24},{"diffs":[[0,"nse) {\r\n"],[-1,"//"],[0,"\t\t\t\t\t\tto"]],"start1":7764,"start2":7764,"length1":18,"length2":16},{"diffs":[[0,"response);\r\n"],[-1,"//"],[0,"\t\t\t\t\t});\r\n//"]],"start1":7782,"start2":7782,"length1":26,"length2":24},{"diffs":[[0,");\r\n"],[-1,"//"],[0,"\t\t\t\t}\r\n"],[-1,"//"],[0,"\t\t})"]],"start1":7800,"start2":7800,"length1":19,"length2":15}]],"length":14584,"saved":false}
{"contributors":[],"silentsave":false,"ts":1355618552559,"patch":[[{"diffs":[[0,"   _epub"],[-1,"v"],[1,"V"],[0,"ersion ="]],"start1":7121,"start2":7121,"length1":17,"length2":17},{"diffs":[[0,"Int("],[-1,"$('<div/>').append($(f)).find(epub_version_tag).attr('"],[1,"xml.getAttribute(\""],[0,"version"],[-1,"'"],[1,"\""],[0,"), 1"]],"start1":7144,"start2":7144,"length1":70,"length2":34},{"diffs":[[0," 10);\r\n\t"],[-1,"\r\n"],[1,"console.log(_epubVersion);\r\n//"],[0,"        "]],"start1":7176,"start2":7176,"length1":18,"length2":46},{"diffs":[[0,".each(\r\n"],[1,"//"],[0,"\t\t\tfunct"]],"start1":7245,"start2":7245,"length1":16,"length2":18},{"diffs":[[0,"nction() {\r\n"],[1,"//"],[0,"\t\t\t\t// Cheat"]],"start1":7260,"start2":7260,"length1":24,"length2":26},{"diffs":[[0,"in NCX\r\n"],[1,"//"],[0,"\t\t\t\t// m"]],"start1":7318,"start2":7318,"length1":16,"length2":18},{"diffs":[[0,"upport\r\n"],[1,"//"],[0,"\t\t\t\tif ("]],"start1":7363,"start2":7363,"length1":16,"length2":18},{"diffs":[[0," != -1\r\n"],[1,"//"],[0,"\t\t\t\t\t\t||"]],"start1":7417,"start2":7417,"length1":16,"length2":18},{"diffs":[[0,"= 'toc') {\r\n"],[1,"//"],[0,"\t\t\t\t\tif(oebp"]],"start1":7471,"start2":7471,"length1":24,"length2":26},{"diffs":[[0,"ebps_dir){\r\n"],[1,"//"],[0,"            "]],"start1":7494,"start2":7494,"length1":24,"length2":26},{"diffs":[[0,"r('href');\r\n"],[1,"//"],[0,"\t\t\t\t\t}\r\n"],[1,"//"],[0,"\t\t\t\t\telse{\r\n"]],"start1":7572,"start2":7572,"length1":32,"length2":36},{"diffs":[[0,"\telse{\r\n"],[1,"//"],[0,"\t\t\t\t\t\tnc"]],"start1":7600,"start2":7600,"length1":16,"length2":18},{"diffs":[[0,"r('href');\r\n"],[1,"//"],[0,"\t\t\t\t\t}\r\n"],[1,"//"],[0,"\t\t\t\t\t// jQue"]],"start1":7639,"start2":7639,"length1":32,"length2":36},{"diffs":[[0," {}, toc);\r\n"],[1,"//"],[0,"\t\t\t\t\t// cons"]],"start1":7691,"start2":7691,"length1":24,"length2":26},{"diffs":[[0,"ncx_file);\r\n"],[1,"//"],[0,"\t\t\t\t\tgetData"]],"start1":7725,"start2":7725,"length1":24,"length2":26},{"diffs":[[0,"esponse) {\r\n"],[1,"//"],[0,"\t\t\t\t\t\ttoc(re"]],"start1":7780,"start2":7780,"length1":24,"length2":26},{"diffs":[[0,"response);\r\n"],[1,"//"],[0,"\t\t\t\t\t});\r\n\t\t"]],"start1":7804,"start2":7804,"length1":24,"length2":26},{"diffs":[[0,"\t\t\t});\r\n"],[1,"//"],[0,"\t\t\t\t}\r\n"],[1,"//"],[0,"\t\t});\r\n "]],"start1":7820,"start2":7820,"length1":23,"length2":27}]],"length":14612,"saved":false}
{"ts":1355619019132,"patch":[[{"diffs":[[0,"  \r\n"],[-1,"        if ($(f).find('opf\\\\:item').length == 0) {\r\n            opf_item_tag = 'item';\r\n            epub_version_tag = 'package';\r\n        }\r\n"],[0,"    "]],"start1":6960,"start2":6960,"length1":150,"length2":8},{"diffs":[[0,"sion);\r\n"],[-1,"//"],[0,"        "]],"start1":7062,"start2":7062,"length1":18,"length2":16},{"diffs":[[0,".each(\r\n"],[-1,"//"],[0,"\t\t\tfunct"]],"start1":7101,"start2":7101,"length1":18,"length2":16},{"diffs":[[0,"nction() {\r\n"],[-1,"//"],[0,"\t\t\t\t// Cheat"]],"start1":7114,"start2":7114,"length1":26,"length2":24},{"diffs":[[0,"in NCX\r\n"],[-1,"//"],[0,"\t\t\t\t// m"]],"start1":7170,"start2":7170,"length1":18,"length2":16},{"diffs":[[0,"upport\r\n"],[-1,"//"],[0,"\t\t\t\tif ("]],"start1":7213,"start2":7213,"length1":18,"length2":16},{"diffs":[[0," != -1\r\n"],[-1,"//"],[0,"\t\t\t\t\t\t||"]],"start1":7265,"start2":7265,"length1":18,"length2":16},{"diffs":[[0,"= 'toc') {\r\n"],[-1,"//"],[0,"\t\t\t\t\tif(oebp"]],"start1":7317,"start2":7317,"length1":26,"length2":24},{"diffs":[[0,"_dir){\r\n"],[-1,"//"],[0,"        "]],"start1":7342,"start2":7342,"length1":18,"length2":16},{"diffs":[[0,"r('href');\r\n"],[-1,"//"],[0,"\t\t\t\t\t}\r\n"],[-1,"//"],[0,"\t\t\t\t\telse{\r\n"]],"start1":7414,"start2":7414,"length1":36,"length2":32},{"diffs":[[0,"\telse{\r\n"],[-1,"//"],[0,"\t\t\t\t\t\tnc"]],"start1":7438,"start2":7438,"length1":18,"length2":16},{"diffs":[[0,");\r\n"],[-1,"//"],[0,"\t\t\t\t\t}\r\n"],[-1,"//"],[0,"\t\t\t\t"]],"start1":7483,"start2":7483,"length1":20,"length2":16},{"diffs":[[0," {}, toc);\r\n"],[-1,"//"],[0,"\t\t\t\t\t// cons"]],"start1":7523,"start2":7523,"length1":26,"length2":24},{"diffs":[[0,"ncx_file);\r\n"],[-1,"//"],[0,"\t\t\t\t\tgetData"]],"start1":7555,"start2":7555,"length1":26,"length2":24},{"diffs":[[0,"nse) {\r\n"],[-1,"//"],[0,"\t\t\t\t\t\tto"]],"start1":7612,"start2":7612,"length1":18,"length2":16},{"diffs":[[0,"response);\r\n"],[-1,"//"],[0,"\t\t\t\t\t});\r\n//"]],"start1":7630,"start2":7630,"length1":26,"length2":24},{"diffs":[[0,");\r\n"],[-1,"//"],[0,"\t\t\t\t}\r\n"],[-1,"//"],[0,"\t\t})"]],"start1":7648,"start2":7648,"length1":19,"length2":15}]],"length":14432,"saved":false}
{"ts":1355619023224,"patch":[[{"diffs":[[0,", 10);\r\n"],[1,"        \r\n"],[0,"\tconsole"]],"start1":7033,"start2":7033,"length1":16,"length2":26}]],"length":14442,"saved":false}
{"ts":1355619104233,"patch":[[{"diffs":[[0,"';\r\n"],[-1,"        var epub_version_tag = 'package';\r\n"],[0,"    "]],"start1":6911,"start2":6911,"length1":51,"length2":8}]],"length":14399,"saved":false}
{"ts":1355619357965,"patch":[[{"diffs":[[0,"rsion;\r\n"],[1,"    var _ncx;\r\n"],[0,"    ////"]],"start1":1064,"start2":1064,"length1":16,"length2":31}]],"length":14414,"saved":false}
{"ts":1355619378172,"patch":[[{"diffs":[[0,"    "],[-1,"    \r\n\tconsole.log(_epubVersion);\r\n        $(f).find(opf_item_tag).each(\r\n\t\t\tfunction() {\r\n\t\t\t\t// Cheat and find the first file ending in NCX\r\n\t\t\t\t// modified to include ePub 3 support\r\n\t\t\t\tif ($(this).attr('href').indexOf('.ncx') != -1\r\n\t\t\t\t\t\t|| $(this).attr('id').toLowerCase() === 'toc') {\r\n\t\t\t\t\tif(oebps_dir){\r\n                        ncx_file = oebps_dir + '/' + $(this).attr('href');\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse{\r\n\t\t\t\t\t\tncx_file =  $(this).attr('href');\r\n\t\t\t\t\t}\r\n\t\t\t\t\t// jQuery.get(ncx_file, {}, toc);\r\n\t\t\t\t\t// console.log(ncx_file);\r\n\t\t\t\t\tgetDataFromEpub(ncx_file, function(response) {\r\n\t\t\t\t\t\ttoc(response);\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t});"],[0,"\r\n  "]],"start1":7013,"start2":7013,"length1":637,"length2":8}]],"length":13785,"saved":false}
{"ts":1355619396981,"patch":[[{"diffs":[[0,");\r\n"],[-1,"        //Additions Dec 15, 2012\r\n        // Get the NCX\r\n        var opf_item_tag = 'item';\r\n    \r\n        \r\n"],[0,"    "]],"start1":6832,"start2":6832,"length1":118,"length2":8}]],"length":13675,"saved":false}
{"ts":1355619413055,"patch":[[{"diffs":[[0,"];\r\n"],[-1,"\r\n            opf.manifest[node.getAttribute(\"id\")"],[1,"            var id = node.getAttribute(\"id\");\r\n            \r\n            if ($(this).attr('href').indexOf('.ncx') != -1\r\n    \t\t\t\t\t|| $(this).attr('id').toLowerCase() === 'toc') {\r\n\t\t\t\t\tif(oebps_dir){\r\n                        ncx_file = oebps_dir + '/' + $(this).attr('href');\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse{\r\n\t\t\t\t\t\tncx_file =  $(this).attr('href');\r\n\t\t\t\t\t}\r\n\t\t\t\t\t// jQuery.get(ncx_file, {}, toc);\r\n\t\t\t\t\t// console.log(ncx_file);\r\n\t\t\t\t\tgetDataFromEpub(ncx_file, function(response) {\r\n\t\t\t\t\t\ttoc(response);\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n            \r\n            opf.manifest[id"],[0,"] = "]],"start1":6236,"start2":6236,"length1":58,"length2":559}]],"length":14176,"saved":false}
{"ts":1355619435378,"patch":[[{"diffs":[[0,");\r\n            "],[1,"var href= node.getAttribute(\"href\");"],[0,"\r\n            if"]],"start1":6283,"start2":6283,"length1":32,"length2":68}]],"length":14212,"saved":false}
{"ts":1355619456680,"patch":[[{"diffs":[[0,"    if ("],[-1,"$(this).attr('"],[0,"href"],[-1,"')"],[0,".indexOf"]],"start1":6345,"start2":6345,"length1":36,"length2":20},{"diffs":[[0,"\t|| "],[-1,"$(this).attr('id')"],[1,"id"],[0,".toL"]],"start1":6389,"start2":6389,"length1":26,"length2":10}]],"length":14180,"saved":false}
{"ts":1355619569525,"patch":[[{"diffs":[[0,"e(\"item\");\r\n"],[1,"        \r\n        var ncxFile = '';"],[0,"\r\n        fo"]],"start1":6113,"start2":6113,"length1":24,"length2":59},{"diffs":[[0,"e(\"href\");\r\n"],[1,"            \r\n"],[0,"            "]],"start1":6360,"start2":6360,"length1":24,"length2":38},{"diffs":[[0,"     ncx"],[-1,"_"],[0,"file = o"]],"start1":6513,"start2":6513,"length1":17,"length2":16}]],"length":14228,"saved":false}
{"ts":1355619590720,"patch":[[{"diffs":[[0,"e = "],[-1,"oebps_dir + '/' + $(this).attr('href')"],[1,"h"],[0,";\r\n\t"]],"start1":6524,"start2":6524,"length1":46,"length2":9}]],"length":14191,"saved":false}
{"ts":1355619613467,"patch":[[{"diffs":[[0,"\t\t\t\t"],[-1,"\tif(oebps_dir){\r\n                        ncxfile = h;\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse{\r\n\t\t\t\t\t\tncx_file =  $(this).attr('"],[1,"ncxfile = "],[0,"href"],[-1,"')"],[0,";\r\n"],[-1,"\t\t\t\t\t}\r\n\t\t\t\t\t// jQuery.get(ncx_file, {}, toc);\r\n\t\t\t\t\t// console.log(ncx_file);\r\n\t\t\t\t\tgetDataFromEpub(ncx_file, function(response) {\r\n\t\t\t\t\t\ttoc(response);\r\n\t\t\t\t\t});"],[0,"\r\n\t\t"]],"start1":6473,"start2":6473,"length1":287,"length2":25}]],"length":13929,"saved":false}
{"ts":1355619629221,"patch":[[{"diffs":[[0,"\n\t\t\t\tncx"],[-1,"f"],[1,"F"],[0,"ile = hr"]],"start1":6472,"start2":6472,"length1":17,"length2":17},{"diffs":[[0," href;\r\n"],[-1,"\r\n\t"],[0,"\t\t\t}\r\n  "]],"start1":6486,"start2":6486,"length1":19,"length2":16},{"diffs":[[0,"}\r\n    \r"],[1,"\n    function re\r"],[0,"\n\r\n    f"]],"start1":7174,"start2":7174,"length1":16,"length2":33}]],"length":13943,"saved":false}
{"ts":1355619722505,"patch":[[{"diffs":[[0,", 10);\r\n    "],[1,"    if(ncxFile){\r\n            _ncx = readNcx(_files[ncxFile]);\r\n        }"],[0,"\r\n        \r\n"]],"start1":7146,"start2":7146,"length1":24,"length2":97},{"diffs":[[0,"ction re"],[1,"adNcx(xml){\r\n        \r\n    }"],[0,"\r\n\r\n    "]],"start1":7263,"start2":7263,"length1":16,"length2":44}]],"length":14044,"saved":false}
{"ts":1355619748521,"patch":[[{"diffs":[[0,"rn _opf;},\r\n"],[1,"        ncx:                function(){return _ncx;},\r\n"],[0,"        publ"]],"start1":13759,"start2":13759,"length1":24,"length2":79}]],"length":14099,"saved":false}
{"ts":1355619766439,"patch":[[{"diffs":[[0,"(xml){\r\n        "],[1,"var doc = xmlDocument(xml);"],[0,"\r\n    }\r\n\r\n    f"]],"start1":7276,"start2":7276,"length1":32,"length2":59}]],"length":14126,"saved":false}
{"ts":1355619924442,"patch":[[{"diffs":[[0,"ment(xml);\r\n"],[1,"        \r\n        // ePub 2 compatibility to parse toc.ncx file\r\n        if (epub_version === 2) {\r\n    \t\r\n            // Some ebooks use navPoint while others use ns:navPoint tags\r\n            var nav_tag = 'ns\\\\:navPoint';\r\n            var content_tag = 'ns\\\\:content';\r\n            var text_tag = 'ns\\\\:text';\r\n\t\t\r\n            if ($(f).find('ns\\\\:navPoint').length == 0) {\r\n                nav_tag = 'navPoint';\r\n                content_tag = 'content';\r\n                text_tag = 'text';\r\n            }\r\n\t\t\r\n            $(f).find(nav_tag).each(\r\n                function() {\r\n                    \r\n                    var link;\r\n                    \r\n                    if(oebps_dir){\r\n                        link = oebps_dir + '/' + $(this).find(content_tag).attr('src');\r\n    \t\t\t\t}\r\n\t\t\t\t\telse{\r\n\t\t\t\t\t\tlink = $(this).find(content_tag).attr('src');\r\n\t\t\t\t\t}\r\n                    \r\n                    var title = $(this).find(text_tag+':first').text()\r\n                    var s = $('<span/>').text(title);\r\n\t\t\t\t\tvar a = $('<a/>').attr(\r\n\t\t\t\t\t\t\t'href',\r\n\t\t\t\t\t\t\tlink);\r\n\t\t\t\t\t// If 's' has a parent navPoint, indent it\r\n\t\t\t\t\tif ($(this).parent()[0].tagName.toLowerCase() == nav_tag ) {\r\n\t\t\t\t\t\ts.addClass('indent');\r\n\t\t\t\t\t}\r\n\t\t\t\t\ts.appendTo(a);\r\n\t\t\t\t\ta.appendTo($('<li/>').appendTo('#toc'));\r\n                    \r\n                    toc_arr[toc_arr.length()] = new TOCItem(title,link);\r\n            }); \r\n        }\r\n\r\n        // ePub 3 compatibility to parse toc.xhtml file\r\n        if (epub_version === 3) {\r\n            $(f).filter('nav[epub:type=\"toc\"]').find('li').each(\r\n                function() {\r\n                    var link;\r\n                    \r\n                    if(oebps_dir){\r\n                        link = oebps_dir + '/' + $(this).find('a:first').attr('href');\r\n                    }\r\n\t\t\t\t\telse{\r\n\t\t\t\t\t\tlink =  $(this).find('a:first').attr('href');\r\n\t\t\t\t\t}\r\n                    var title = $(this).find('a:first').text();\r\n\t\t\t\t\tvar s = $('<span/>').text(title);\r\n\t\t\t\t\tvar a = $('<a/>').attr('href', link);\r\n\t\t\t\t\t\r\n\t\t\t\t\t// If 's' has a parent navPoint, indent it\r\n\t\t\t\t\tif ($(this).parent().parent()[0].tagName.toLowerCase() === 'li') {\r\n\t\t\t\t\t\ts.addClass('indent');\r\n\t\t\t\t\t}\r\n\t\t\t\t\ts.appendTo(a);\r\n\t\t\t\t\ta.appendTo($('<li/>').appendTo('#toc'));\r\n                    \r\n                    toc_arr[toc_arr.length()] = new TOCItem(title,link);\r\n\t\t\t\t});\r\n        }\r\n"],[0,"    }\r\n\r\n   "]],"start1":7309,"start2":7309,"length1":24,"length2":2407}]],"length":16509,"saved":false}
{"ts":1355619955875,"patch":[[{"diffs":[[0,"le\r\n        if ("],[1,"_"],[0,"epub"],[-1,"_v"],[1,"V"],[0,"ersion === 2) {\r"]],"start1":7382,"start2":7382,"length1":38,"length2":38}]],"length":16509,"saved":false}
{"contributors":[],"silentsave":false,"ts":1355621742327,"patch":[[{"diffs":[[0,"Int(xml."],[1,"getElementsByTagName(\"metadata\")[0]."],[0,"getAttri"]],"start1":7115,"start2":7115,"length1":16,"length2":52}]],"length":16545,"saved":false}
{"ts":1355621787779,"patch":[[{"diffs":[[0,"sByTagName(\""],[-1,"metadata"],[1,"package"],[0,"\")[0].getAtt"]],"start1":7133,"start2":7133,"length1":32,"length2":31}]],"length":16544,"saved":false}
{"ts":1355622384051,"patch":[[{"diffs":[[0,"\n    \t\r\n"],[1,"//"],[0,"        "]],"start1":7455,"start2":7455,"length1":16,"length2":18},{"diffs":[[0,"Point tags\r\n"],[1,"//"],[0,"            "]],"start1":7528,"start2":7528,"length1":24,"length2":26},{"diffs":[[0,"s\\\\:navPoint';\r\n"],[1,"//"],[0,"            var "]],"start1":7570,"start2":7570,"length1":32,"length2":34},{"diffs":[[0,"ns\\\\:content';\r\n"],[1,"//"],[0,"            var "]],"start1":7619,"start2":7619,"length1":32,"length2":34},{"diffs":[[0,"text';\r\n"],[1,"//"],[0,"\t\t\r\n"],[1,"//"],[0,"        "]],"start1":7670,"start2":7670,"length1":20,"length2":24},{"diffs":[[0,"th == 0) {\r\n"],[1,"//"],[0,"            "]],"start1":7733,"start2":7733,"length1":24,"length2":26},{"diffs":[[0,"navPoint';\r\n"],[1,"//"],[0,"            "]],"start1":7774,"start2":7774,"length1":24,"length2":26},{"diffs":[[0,"'content';\r\n"],[1,"//"],[0,"            "]],"start1":7818,"start2":7818,"length1":24,"length2":26},{"diffs":[[0," = 'text';\r\n"],[1,"//"],[0,"            "]],"start1":7856,"start2":7856,"length1":24,"length2":26},{"diffs":[[0,"     }\r\n"],[1,"            var navPointEntries = doc\r\n            .getElementsByTagName(\"manifest\")[0]\r\n            .getElementsByTagName(\"item\");\r\n"],[0,"\t\t\r\n    "]],"start1":7877,"start2":7877,"length1":16,"length2":149}]],"length":16697,"saved":false}
{"ts":1355624060656,"patch":[[{"diffs":[[0,"me(\""],[-1,"manifest\")[0]\r\n            .getElementsByTagName(\"item\");\r\n\t\t"],[1,"navMap\")[0]\r\n            .getElementsByTagName(\"navPoint\");\r\n\t\t\r\n            \r\n            for (var i = 0, il = navPointEntries.length; i < il; i++) {\r\n                var node = navPointEntries[i];\r\n                var link = node.getElementsByTagName(\"content\").getAttribute(\"src\");\r\n            }"],[0,"\r\n  "]],"start1":7955,"start2":7955,"length1":69,"length2":307}]],"length":16935,"saved":false}
{"ts":1355626078502,"patch":[[{"diffs":[[0,"ribute(\"src\");\r\n"],[1,"//"],[0,"            }\r\n "]],"start1":8229,"start2":8229,"length1":32,"length2":34},{"diffs":[[0,"    "],[-1,"}\r\n            $(f).find(nav_tag).each("],[1,"    if(oebps_dir){\r\n//                    link = oebps_dir + '/' + $(this).find(content_tag).attr('src');\r\n//        \t\t}\r\n//\t\t\t\telse{\r\n//\t\t\t\t\tlink = $(this).find(content_tag).attr('src');\r\n//\t\t\t\t}"],[0,"\r\n  "]],"start1":8255,"start2":8255,"length1":47,"length2":204},{"diffs":[[0,"            "],[-1,"function() {"],[1,"var title = "],[0,"\r\n          "]],"start1":8461,"start2":8461,"length1":36,"length2":36},{"diffs":[[0,"tle = \r\n        "],[1,"    }\r\n"],[0,"            \r\n  "]],"start1":8479,"start2":8479,"length1":32,"length2":39},{"diffs":[[0," }\r\n            "],[-1,"\r\n    "],[1,"$(f).find(nav_tag).each(\r\n"],[0,"                "]],"start1":8498,"start2":8498,"length1":38,"length2":58},{"diffs":[[0,"            "],[-1,"var link;"],[1,"function() {"],[0,"\r\n          "]],"start1":8544,"start2":8544,"length1":33,"length2":36},{"diffs":[[0,"            "],[-1,"if(oebps_dir){"],[1,"var link;"],[0,"\r\n          "]],"start1":8600,"start2":8600,"length1":38,"length2":33},{"diffs":[[0,"    "],[1,"\r\n"],[0,"    "],[-1,"link = oebps_dir + '/' + $(this).find(content_tag).attr('src');\r\n    \t\t\t\t}\r\n\t\t\t\t\telse{\r\n\t\t\t\t\t\tlink = $(this).find(content_tag).attr('src');\r\n\t\t\t\t\t}"],[1,"                "],[0,"\r\n  "]],"start1":8639,"start2":8639,"length1":159,"length2":30}]],"length":16990,"saved":false}
{"ts":1355626799382,"patch":[[{"diffs":[[0,"title = "],[1,"node.getElementsByTagName(\"text\")[0].text;"],[0,"\r\n      "]],"start1":8477,"start2":8477,"length1":16,"length2":58},{"diffs":[[0,"      }\r\n    }\r\n"],[1,"    \r\n    function recursiveNcxParser(navPoint){\r\n        \r\n        \r\n    }\r\n    "],[0,"\r\n    function r"]],"start1":10218,"start2":10218,"length1":32,"length2":113}]],"length":17113,"saved":false}
{"ts":1355626803584,"patch":[[{"diffs":[[0,"navPoint"],[1,"Element"],[0,"){\r\n    "]],"start1":10272,"start2":10272,"length1":16,"length2":23}]],"length":17120,"saved":false}
{"ts":1355627094343,"patch":[[{"diffs":[[0,"ment){\r\n        "],[1,"var navPointChildren = navPointElement.children"],[0,"\r\n        \r\n    "]],"start1":10283,"start2":10283,"length1":32,"length2":79}]],"length":17167,"saved":false}
{"ts":1355627205257,"patch":[[{"diffs":[[0,"children"],[1,";\r\n        \r\n        var node = navPointEntries[i];\r\n        var link = node.getElementsByTagName(\"content\").getAttribute(\"src\");"],[0,"\r\n      "]],"start1":10338,"start2":10338,"length1":16,"length2":145}]],"length":17296,"saved":false}
{"ts":1355627416231,"patch":[[{"diffs":[[0,"  \r\n"],[-1,"        var node = navPointEntries[i];\r\n"],[0,"    "]],"start1":10355,"start2":10355,"length1":48,"length2":8},{"diffs":[[0,"src\");\r\n        "],[1,"var title = node.getElementsByTagName(\"text\")[0].text;\r\n        \r\n        var tocItem - {}\r\n    }\r\n    \r\n    function tocItem(title, src){\r\n        this.title = title;\r\n        this.src = src;"],[0,"\r\n    }\r\n    \r\n "]],"start1":10429,"start2":10429,"length1":32,"length2":224}]],"length":17448,"saved":false}
{"ts":1355627446177,"patch":[[{"diffs":[[0,"src = src;\r\n"],[1,"        this.children = [];\r\n"],[0,"    }\r\n    \r"]],"start1":10627,"start2":10627,"length1":24,"length2":53}]],"length":17477,"saved":false}
{"ts":1355627545392,"patch":[[{"diffs":[[0,"tem "],[-1,"- {"],[1,"= new tocItem(title,link);\r\n        \r\n        for (var i = 0, il = navPointChildren.length; i < il; i++) {\r\n            \r\n        "],[0,"}\r\n "]],"start1":10527,"start2":10527,"length1":11,"length2":138},{"diffs":[[0,"unction "],[-1,"t"],[1,"T"],[0,"ocItem(t"]],"start1":10682,"start2":10682,"length1":17,"length2":17}]],"length":17604,"saved":false}
{"ts":1355627562075,"patch":[[{"diffs":[[0," {\r\n            "],[1,"var child = navPointChildren[i];"],[0,"\r\n        }\r\n   "]],"start1":10635,"start2":10635,"length1":32,"length2":64}]],"length":17636,"saved":false}
{"ts":1355627567161,"patch":[[{"diffs":[[0,"ar child"],[1,"NavPoint"],[0," = navPo"]],"start1":10652,"start2":10652,"length1":16,"length2":24}]],"length":17644,"saved":false}
{"ts":1355627774352,"patch":[[{"diffs":[[0,"ildren[i];\r\n"],[1,"            if(childNavPoint.nodeName.toLowerCase() == \"navPoint\"){\r\n                tocItem.push(recursiveNcxParser(childNavPoint))\r\n            }\r\n"],[0,"        }\r\n "]],"start1":10681,"start2":10681,"length1":24,"length2":173}]],"length":17793,"saved":false}
{"ts":1355627776658,"patch":[[{"diffs":[[0,"vPoint))"],[1,";"],[0,"\r\n      "]],"start1":10817,"start2":10817,"length1":16,"length2":17}]],"length":17794,"saved":false}
{"ts":1355627788984,"patch":[[{"diffs":[[0,"  }\r\n        }\r\n"],[1,"        return tocItem;\r\n"],[0,"    }\r\n    \r\n   "]],"start1":10838,"start2":10838,"length1":32,"length2":57}]],"length":17819,"saved":false}
{"ts":1355627813718,"patch":[[{"diffs":[[0,"var navPoint"],[1,"Top"],[0,"Entries = do"]],"start1":7897,"start2":7897,"length1":24,"length2":27}]],"length":17822,"saved":false}
{"ts":1355627834613,"patch":[[{"diffs":[[0,"PointTop"],[1,"Level"],[0,"Entries "]],"start1":7904,"start2":7904,"length1":16,"length2":21}]],"length":17827,"saved":false}
{"ts":1355627839794,"patch":[[{"diffs":[[0,"   ."],[-1,"getElementsByTagName(\"navPoint\")"],[1,"children"],[0,";\r\n\t"]],"start1":7989,"start2":7989,"length1":40,"length2":16}]],"length":17803,"saved":false}
{"ts":1355627989487,"patch":[[{"diffs":[[0,"l = navPoint"],[1,"TopLevel"],[0,"Entries.leng"]],"start1":8051,"start2":8051,"length1":24,"length2":32},{"diffs":[[0,"navPoint"],[1,"TopLevel"],[0,"Entries["]],"start1":8130,"start2":8130,"length1":16,"length2":24}]],"length":17819,"saved":false}
{"ts":1355628013755,"patch":[[{"diffs":[[0,"    var link = n"],[-1,"ode"],[1,"avPointElement"],[0,".getElementsByTa"]],"start1":10363,"start2":10363,"length1":35,"length2":46},{"diffs":[[0,"   var title = n"],[-1,"ode"],[1,"avPointElement"],[0,".getElementsByTa"]],"start1":10453,"start2":10453,"length1":35,"length2":46}]],"length":17841,"saved":false}
{"ts":1355628273530,"patch":[[{"diffs":[[0,"velEntries[i];\r\n"],[1,"                if(childNavPoint.nodeName.toLowerCase() == \"navpoint\"){\r\n                    continue;\r\n                }\r\n                \r\n                \r\n"],[0,"                "]],"start1":8143,"start2":8143,"length1":32,"length2":191},{"diffs":[[0,"nction recursive"],[1,"2"],[0,"NcxParser(navPoi"]],"start1":10405,"start2":10405,"length1":32,"length2":33},{"diffs":[[0," == \"nav"],[-1,"P"],[1,"p"],[0,"oint\"){\r"]],"start1":10926,"start2":10926,"length1":17,"length2":17}]],"length":18001,"saved":false}
{"ts":1355628277454,"patch":[[{"diffs":[[0,"         if("],[-1,"childNavPoint"],[1,"node"],[0,".nodeName.to"]],"start1":8166,"start2":8166,"length1":37,"length2":28}]],"length":17992,"saved":false}
{"ts":1355628281032,"patch":[[{"diffs":[[0,"e.toLowerCase() "],[-1,"="],[1,"!"],[0,"= \"navpoint\"){\r\n"]],"start1":8190,"start2":8190,"length1":33,"length2":33}]],"length":17992,"saved":false}
{"ts":1355628312174,"patch":[[{"diffs":[[0,"ml);\r\n        \r\n"],[1,"        var tocItems = [];\r\n        \r\n"],[0,"        // ePub "]],"start1":7350,"start2":7350,"length1":32,"length2":70}]],"length":18030,"saved":false}
{"ts":1355628402979,"patch":[[{"diffs":[[0,"              \r\n"],[1,"                tocItems.push(recursive2NcxParser(node));\r\n"],[0,"                "]],"start1":8313,"start2":8313,"length1":32,"length2":91}]],"length":18089,"saved":false}
{"ts":1355628438552,"patch":[[{"diffs":[[0,"    "],[-1,"var link = node.getElementsByTagName(\"content\").getAttribute(\"src\");"],[0,"\r\n//"]],"start1":8418,"start2":8418,"length1":76,"length2":8},{"diffs":[[0,"\t}\r\n"],[-1,"                var title = node.getElementsByTagName(\"text\")[0].text;\r\n"],[0,"    "]],"start1":8632,"start2":8632,"length1":80,"length2":8}]],"length":17949,"saved":false}
{"ts":1355628510022,"patch":[[{"diffs":[[0,"    "],[-1,"$(f).find(nav_tag).each(\r\n                function() {\r\n                    \r\n                    var link;\r\n                    \r\n                    \r\n                    \r\n                    var title = $(this).find(text_tag+':first').text()\r\n                    var s = $('<span/>').text(title);\r\n\t\t\t\t\tvar a = $('<a/>').attr(\r\n\t\t\t\t\t\t\t'href',\r\n\t\t\t\t\t\t\tlink);\r\n\t\t\t\t\t// If 's' has a parent navPoint, indent it\r\n\t\t\t\t\tif ($(this).parent()[0].tagName.toLowerCase() == nav_tag ) {\r\n\t\t\t\t\t\ts.addClass('indent');\r\n\t\t\t\t\t}\r\n\t\t\t\t\ts.appendTo(a);\r\n\t\t\t\t\ta.appendTo($('<li/>').appendTo('#toc'));\r\n                    \r\n                    toc_arr[toc_arr.length()] = new TOCItem(title,link);\r\n            });"],[0," \r\n "]],"start1":8659,"start2":8659,"length1":703,"length2":8}]],"length":17254,"saved":false}
{"ts":1355629035494,"patch":[[{"diffs":[[0," [];\r\n        \r\n"],[1,"        \r\n\r\n        // ePub 3 compatibility to parse toc.xhtml file\r\n        if (epub_version === 3) {\r\n            $(f).filter('nav[epub:type=\"toc\"]').find('li').each(\r\n                function() {\r\n                    var link;\r\n                    \r\n                    if(oebps_dir){\r\n                        link = oebps_dir + '/' + $(this).find('a:first').attr('href');\r\n                    }\r\n\t\t\t\t\telse{\r\n\t\t\t\t\t\tlink =  $(this).find('a:first').attr('href');\r\n\t\t\t\t\t}\r\n                    var title = $(this).find('a:first').text();\r\n\t\t\t\t\tvar s = $('<span/>').text(title);\r\n\t\t\t\t\tvar a = $('<a/>').attr('href', link);\r\n\t\t\t\t\t\r\n\t\t\t\t\t// If 's' has a parent navPoint, indent it\r\n\t\t\t\t\tif ($(this).parent().parent()[0].tagName.toLowerCase() === 'li') {\r\n\t\t\t\t\t\ts.addClass('indent');\r\n\t\t\t\t\t}\r\n\t\t\t\t\ts.appendTo(a);\r\n\t\t\t\t\ta.appendTo($('<li/>').appendTo('#toc'));\r\n                    \r\n                    toc_arr[toc_arr.length()] = new TOCItem(title,link);\r\n\t\t\t\t});\r\n        }\r\n"],[0,"        // ePub "]],"start1":7388,"start2":7388,"length1":32,"length2":1004},{"diffs":[[0,"le\r\n        "],[1,"//"],[0,"if (_epubVer"]],"start1":8427,"start2":8427,"length1":24,"length2":26},{"diffs":[[0," {\r\n    "],[-1,"\t"],[1,"    else{\r\n        "],[0,"\r\n//    "]],"start1":8464,"start2":8464,"length1":17,"length2":35},{"diffs":[[0,"  }\r"],[-1,"\n\r\n        // ePub 3 compatibility to parse toc.xhtml file\r\n        if (epub_version === 3) {\r\n            $(f).filter('nav[epub:type=\"toc\"]').find('li').each(\r\n                function() {\r\n                    var link;\r\n                    \r\n                    if(oebps_dir){\r\n                        link = oebps_dir + '/' + $(this).find('a:first').attr('href');\r\n                    }\r\n\t\t\t\t\telse{\r\n\t\t\t\t\t\tlink =  $(this).find('a:first').attr('href');\r\n\t\t\t\t\t}\r\n                    var title = $(this).find('a:first').text();\r\n\t\t\t\t\tvar s = $('<span/>').text(title);\r\n\t\t\t\t\tvar a = $('<a/>').attr('href', link);\r\n\t\t\t\t\t\r\n\t\t\t\t\t// If 's' has a parent navPoint, indent it\r\n\t\t\t\t\tif ($(this).parent().parent()[0].tagName.toLowerCase() === 'li') {\r\n\t\t\t\t\t\ts.addClass('indent');\r\n\t\t\t\t\t}\r\n\t\t\t\t\ts.appendTo(a);\r\n\t\t\t\t\ta.appendTo($('<li/>').appendTo('#toc'));\r\n                    \r\n                    toc_arr[toc_arr.length()] = new TOCItem(title,link);\r\n\t\t\t\t});\r\n        }\r"],[0,"\n   "]],"start1":9664,"start2":9664,"length1":970,"length2":8}]],"length":17284,"saved":false}
{"ts":1355629494572,"patch":[[{"diffs":[[0,"if ("],[1,"_"],[0,"epub"],[-1,"_v"],[1,"V"],[0,"ersi"]],"start1":7481,"start2":7481,"length1":14,"length2":14}]],"length":17284,"saved":false}
{"ts":1355629537814,"patch":[[{"diffs":[[0,"n === 3) {\r\n"],[1,"            \r\n            var navPointTopLevelEntries = doc\r\n            .getElementsByTagName(\"navMap\")[0]\r\n            .children;\r\n            \r\n"],[0,"            "]],"start1":7496,"start2":7496,"length1":24,"length2":171}]],"length":17431,"saved":false}
{"ts":1355630149163,"patch":[[{"diffs":[[0,"tsByTagName(\"nav"],[-1,"Map"],[0,"\")[0]\r\n         "]],"start1":7591,"start2":7591,"length1":35,"length2":32},{"diffs":[[0,"ldren;\r\n"],[-1,"            \r\n"],[0,"        "]],"start1":7630,"start2":7630,"length1":30,"length2":16}]],"length":17414,"saved":false}
{"ts":1355630178601,"patch":[[{"diffs":[[0,"    .children;\r\n"],[1,"            \r\n            for (var i = 0, il = navPointTopLevelEntries.length; i < il; i++) {\r\n                var node = navPointTopLevelEntries[i];\r\n                if(node.nodeName.toLowerCase() != \"navpoint\"){\r\n                    continue;\r\n                }\r\n                \r\n                tocItems.push(recursive2NcxParser(node));\r\n                \r\n                \r\n//                if(oebps_dir){\r\n//                    link = oebps_dir + '/' + $(this).find(content_tag).attr('src');\r\n//            \t}\r\n//\t\t\t\telse{\r\n//\t\t\t\t\tlink = $(this).find(content_tag).attr('src');\r\n//\t\t\t\t}\r\n            }\r\n            \r\n            \r\n"],[0,"            $(f)"]],"start1":7622,"start2":7622,"length1":32,"length2":668}]],"length":18050,"saved":false}
{"ts":1355630253704,"patch":[[{"diffs":[[0,"ode."],[-1,"nodeName.toLowerCase() != \"navpoint\""],[1,"getAttribute(\"type\") == \"toc\" "],[0,"){\r\n"]],"start1":7809,"start2":7809,"length1":44,"length2":38}]],"length":18044,"saved":false}
{"ts":1355630258050,"patch":[[{"diffs":[[0,"\"type\") "],[-1,"="],[1,"!"],[0,"= \"toc\" "]],"start1":7826,"start2":7826,"length1":17,"length2":17}]],"length":18044,"saved":false}
{"ts":1355630427791,"patch":[[{"diffs":[[0,";\r\n    }\r\n    \r\n"],[1,"    function recursive3NcxParser(liElement)\r\n    \r\n    \r\n"],[0,"    function Toc"]],"start1":11101,"start2":11101,"length1":32,"length2":89}]],"length":18101,"saved":false}
{"ts":1355630431439,"patch":[[{"diffs":[[0,"Element)"],[1,"{\r\n        \r\n    }"],[0,"\r\n    \r\n"]],"start1":11152,"start2":11152,"length1":16,"length2":34}]],"length":18119,"saved":false}
{"ts":1355630446104,"patch":[[{"diffs":[[0,"ment){\r\n        "],[1,"var liChildren = navPointElement.children;\r\n        \r\n        var link = navPointElement.getElementsByTagName(\"content\").getAttribute(\"src\");\r\n        var title = navPointElement.getElementsByTagName(\"text\")[0].text;\r\n        \r\n        var tocItem = new tocItem(title,link);\r\n        \r\n        for (var i = 0, il = navPointChildren.length; i < il; i++) {\r\n            var childNavPoint = navPointChildren[i];\r\n            if(childNavPoint.nodeName.toLowerCase() == \"navpoint\"){\r\n                tocItem.push(recursiveNcxParser(childNavPoint));\r\n            }\r\n        }\r\n        return tocItem;"],[0,"\r\n    }\r\n    \r\n "]],"start1":11155,"start2":11155,"length1":32,"length2":626}]],"length":18713,"saved":false}
{"ts":1355630473875,"patch":[[{"diffs":[[0,"iChildren = "],[-1,"navPoint"],[1,"li"],[0,"Element.chil"]],"start1":11176,"start2":11176,"length1":32,"length2":26},{"diffs":[[0," var link = "],[-1,"navPoint"],[1,"li"],[0,"Element.getE"]],"start1":11226,"start2":11226,"length1":32,"length2":26},{"diffs":[[0,"sByTagName(\""],[-1,"content\")"],[1,"a\")[0]"],[0,".getAttribut"]],"start1":11258,"start2":11258,"length1":33,"length2":30},{"diffs":[[0,"var title = "],[-1,"navPoint"],[1,"li"],[0,"Element.getE"]],"start1":11307,"start2":11307,"length1":32,"length2":26}]],"length":18692,"saved":false}
{"ts":1355630478169,"patch":[[{"diffs":[[0,"ontent\")"],[1,"[0]"],[0,".getAttr"]],"start1":10620,"start2":10620,"length1":16,"length2":19}]],"length":18695,"saved":false}
{"ts":1355630503226,"patch":[[{"diffs":[[0,"].getAttribute(\""],[-1,"src"],[1,"href"],[0,"\");\r\n        var"]],"start1":11278,"start2":11278,"length1":35,"length2":36}]],"length":18696,"saved":false}
{"ts":1355630526860,"patch":[[{"diffs":[[0,"ment.children;\r\n"],[1,"        var liATag = liElement.getElementsByTagName(\"a\")[0];\r\n"],[0,"        \r\n      "]],"start1":11196,"start2":11196,"length1":32,"length2":94}]],"length":18758,"saved":false}
{"ts":1355630541313,"patch":[[{"diffs":[[0,"= li"],[-1,"Element.getElementsByTagName(\"a\")[0]"],[1,"ATag"],[0,".get"]],"start1":11301,"start2":11301,"length1":44,"length2":12},{"diffs":[[0,"= li"],[-1,"Element.getElementsByTagName(\"text\")[0]"],[1,"ATag"],[0,".tex"]],"start1":11351,"start2":11351,"length1":47,"length2":12}]],"length":18691,"saved":false}
{"ts":1355631027301,"patch":[[{"diffs":[[0,"ment.children;\r\n"],[1,"        \r\n        for (var i = 0, il = navPointChildren.length; i < il; i++) {\r\n            var childNavPoint = navPointChildren[i];\r\n            if(childNavPoint.nodeName.toLowerCase() == \"navpoint\"){\r\n                tocItem.push(recursiveNcxParser(childNavPoint));\r\n            }\r\n        }\r\n        \r\n"],[0,"        var liAT"]],"start1":11196,"start2":11196,"length1":32,"length2":337}]],"length":18996,"saved":false}
{"ts":1355631037565,"patch":[[{"diffs":[[0,"i = 0, il = "],[-1,"navPoint"],[1,"li"],[0,"Children.len"]],"start1":11239,"start2":11239,"length1":32,"length2":26}]],"length":18990,"saved":false}
{"ts":1355631445325,"patch":[[{"diffs":[[0,"var "],[-1,"childNavPoint = navPoint"],[1,"a_or_spanElement = li"],[0,"Chil"]],"start1":11298,"start2":11298,"length1":32,"length2":29}]],"length":18987,"saved":false}
{"ts":1355631497190,"patch":[[{"diffs":[[0,"         if("],[-1,"childNavPoi"],[1,"a_or_spanElement.nodeName.toLowerCase() == \"a\" || a_or_spanEleme"],[0,"nt.nodeName."]],"start1":11340,"start2":11340,"length1":35,"length2":88},{"diffs":[[0,"rCase() == \""],[-1,"navpoint"],[1,"span"],[0,"\"){\r\n       "]],"start1":11434,"start2":11434,"length1":32,"length2":28}]],"length":19036,"saved":false}
{"ts":1355631573809,"patch":[[{"diffs":[[0,"ren;\r\n        \r\n"],[1,"        var tocItem;\r\n"],[0,"        for (var"]],"start1":11206,"start2":11206,"length1":32,"length2":54},{"diffs":[[0,"ildNavPoint));\r\n"],[1,"                var link = liATag.getAttribute(\"href\");\r\n                var title = liATag.text;\r\n        \r\n                tocItem = new tocItem(title,link);\r\n"],[0,"            }\r\n "]],"start1":11527,"start2":11527,"length1":32,"length2":193}]],"length":19219,"saved":false}
{"ts":1355631577127,"patch":[[{"diffs":[[0,"  tocItem = new "],[-1,"t"],[1,"T"],[0,"ocItem(title,lin"]],"start1":11666,"start2":11666,"length1":33,"length2":33}]],"length":19219,"saved":false}
{"ts":1355631616108,"patch":[[{"diffs":[[0,"r tocItem = new "],[-1,"t"],[1,"T"],[0,"ocItem(title,lin"]],"start1":10749,"start2":10749,"length1":33,"length2":33},{"diffs":[[0,"    var "],[-1,"a_or_span"],[1,"child"],[0,"Element "]],"start1":11316,"start2":11316,"length1":25,"length2":21},{"diffs":[[0,"     if("],[-1,"a_or_span"],[1,"child"],[0,"Element."]],"start1":11362,"start2":11362,"length1":25,"length2":21},{"diffs":[[0," || "],[-1,"a_or_span"],[1,"child"],[0,"Elem"]],"start1":11412,"start2":11412,"length1":17,"length2":13}]],"length":19207,"saved":false}
{"ts":1355631671114,"patch":[[{"diffs":[[0," var tocItem"],[1," = new TocItem('placeholder title','')"],[0,";\r\n        f"]],"start1":11229,"start2":11229,"length1":24,"length2":62},{"diffs":[[0,"\n            }\r\n"],[1,"            \r\n"],[0,"        }\r\n     "]],"start1":11729,"start2":11729,"length1":32,"length2":46}]],"length":19259,"saved":false}
{"ts":1355631690093,"patch":[[{"diffs":[[0,"Item"],[-1," = new TocItem(title,"],[1,".title =title;\r\n                tocItem.src = "],[0,"link"],[-1,")"],[0,";\r\n "]],"start1":11697,"start2":11697,"length1":34,"length2":58}]],"length":19283,"saved":false}
{"ts":1355631709894,"patch":[[{"diffs":[[0," }\r\n            "],[1,"if(childElement.nodeName.toLowerCase() == \"ol\"){\r\n                \r\n            }"],[0,"\r\n        }\r\n   "]],"start1":11765,"start2":11765,"length1":32,"length2":113}]],"length":19364,"saved":false}
{"ts":1355632279486,"patch":[[{"diffs":[[0,"        tocItem."],[1,"children."],[0,"push(recursiveNc"]],"start1":10998,"start2":10998,"length1":32,"length2":41}]],"length":19373,"saved":false}
{"ts":1355632344250,"patch":[[{"diffs":[[0,"                "],[1,"olChildren = childElement.children;"],[0,"\r\n            }\r"]],"start1":11840,"start2":11840,"length1":32,"length2":67}]],"length":19408,"saved":false}
{"ts":1355632348345,"patch":[[{"diffs":[[0,"        "],[1,"var "],[0,"olChildr"]],"start1":11848,"start2":11848,"length1":16,"length2":20},{"diffs":[[0,"ment.children;\r\n"],[1,"                \r\n"],[0,"            }\r\n "]],"start1":11881,"start2":11881,"length1":32,"length2":50}]],"length":19430,"saved":false}
{"ts":1355632429933,"patch":[[{"diffs":[[0,"                "],[1,"for(var ii = 0, iil = liChildren.length; ii < iil; ii++) {\r\n                    var olChild = olChildren[ii];\r\n                    tocItem.children.push(recursive3NcxParser(olChild))\r\n                    \r\n                }"],[0,"\r\n            }\r"]],"start1":11897,"start2":11897,"length1":32,"length2":255}]],"length":19653,"saved":false}
{"ts":1355632447019,"patch":[[{"diffs":[[0,"lChild))"],[-1,"\r\n"],[0,"        "]],"start1":12087,"start2":12087,"length1":18,"length2":16},{"diffs":[[0,"   }\r\n        \r\n"],[1,"        return tocItem;\r\n"],[0,"        var liAT"]],"start1":12156,"start2":12156,"length1":32,"length2":57}]],"length":19676,"saved":false}
{"ts":1355632463447,"patch":[[{"diffs":[[0,"    "],[-1,"var liATag = liElement.getElementsByTagName(\"a\")[0];\r\n        \r\n        var link = liATag.getAttribute(\"href\");\r\n        var title = liATag.text;\r\n        \r\n        var tocItem = new tocItem(title,link);\r\n        \r\n        for (var i = 0, il = navPointChildren.length; i < il; i++) {\r\n            var childNavPoint = navPointChildren[i];\r\n            if(childNavPoint.nodeName.toLowerCase() == \"navpoint\"){\r\n                tocItem.push(recursiveNcxParser(childNavPoint));\r\n            }\r\n        }\r\n        return tocItem;"],[0,"\r\n  "]],"start1":12201,"start2":12201,"length1":531,"length2":8}]],"length":19153,"saved":false}
{"ts":1355632921318,"patch":[[{"diffs":[[0,"av\")"],[-1,"[0]\r\n            .children"],[0,";\r\n"],[1,""],[0,"    "]],"start1":7605,"start2":7605,"length1":37,"length2":11},{"diffs":[[0,"              \r\n"],[1,"                node.children\r\n"],[0,"                "]],"start1":7873,"start2":7873,"length1":32,"length2":63},{"diffs":[[0,"\n            }\r\n"],[1,""],[0,"            \r\n  "]],"start1":8229,"start2":8229,"length1":32,"length2":32},{"diffs":[[0,"  \r\n"],[-1,"            \r\n            $(f).filter('nav[epub:type=\"toc\"]').find('li').each(\r\n                function() {\r\n                    var link;\r\n                    \r\n                    if(oebps_dir){\r\n                        link = oebps_dir + '/' + $(this).find('a:first').attr('href');\r\n                    }\r\n\t\t\t\t\telse{\r\n\t\t\t\t\t\tlink =  $(this).find('a:first').attr('href');\r\n\t\t\t\t\t}\r\n                    var title = $(this).find('a:first').text();\r\n\t\t\t\t\tvar s = $('<span/>').text(title);\r\n\t\t\t\t\tvar a = $('<a/>').attr('href', link);\r\n\t\t\t\t\t\r\n\t\t\t\t\t// If 's' has a parent navPoint, indent it\r\n\t\t\t\t\tif ($(this).parent().parent()[0].tagName.toLowerCase() === 'li') {\r\n\t\t\t\t\t\ts.addClass('indent');\r\n\t\t\t\t\t}\r\n\t\t\t\t\ts.appendTo(a);\r\n\t\t\t\t\ta.appendTo($('<li/>').appendTo('#toc'));\r\n                    \r\n                    toc_arr[toc_arr.length()] = new TOCItem(title,link);\r\n\t\t\t\t});\r\n"],[0,"    "]],"start1":8255,"start2":8255,"length1":879,"length2":8}]],"length":18287,"saved":false}
{"ts":1355632925736,"patch":[[{"diffs":[[0,"         var nav"],[-1,"Point"],[0,"TopLevelEntries "]],"start1":7525,"start2":7525,"length1":37,"length2":32}]],"length":18282,"saved":false}
{"ts":1355632999084,"patch":[[{"diffs":[[0," i = 0, il = nav"],[-1,"Point"],[0,"TopLevelEntries."]],"start1":7641,"start2":7641,"length1":37,"length2":32},{"diffs":[[0,"  var node = nav"],[-1,"Point"],[0,"TopLevelEntries["]],"start1":7711,"start2":7711,"length1":37,"length2":32},{"diffs":[[0,"        "],[1,"\r\n                var olElement = "],[0,"node.chi"]],"start1":7882,"start2":7882,"length1":16,"length2":50},{"diffs":[[0,"children"],[1,"[0];"],[0,"\r\n      "]],"start1":7929,"start2":7929,"length1":16,"length2":20}]],"length":18310,"saved":false}
{"ts":1355633038693,"patch":[[{"diffs":[[0,"                "],[1,"\r\n                for(var ii = 0, iil = liChildren.length; ii < iil; ii++) {\r\n                    "],[0,"tocItems.push(re"]],"start1":7943,"start2":7943,"length1":32,"length2":130},{"diffs":[[0,"                "],[1,"}"],[0,"\r\n              "]],"start1":8100,"start2":8100,"length1":32,"length2":33}]],"length":18409,"saved":false}
{"ts":1355633051146,"patch":[[{"diffs":[[0,"r ii = 0, iil = "],[-1,"liC"],[1,"olElement.c"],[0,"hildren.length; "]],"start1":7983,"start2":7983,"length1":35,"length2":43}]],"length":18417,"saved":false}
{"ts":1355633085155,"patch":[[{"diffs":[[0,"< iil; ii++) {\r\n"],[1,"                    var liElement = olElement.children[ii];\r\n"],[0,"                "]],"start1":8029,"start2":8029,"length1":32,"length2":93},{"diffs":[[0,"s.push(recursive"],[-1,"2"],[1,"3"],[0,"NcxParser(node))"]],"start1":8133,"start2":8133,"length1":33,"length2":33}]],"length":18478,"saved":false}
{"ts":1355633090443,"patch":[[{"diffs":[[0,"rsive3NcxParser("],[-1,"node"],[1,"liElement"],[0,"));\r\n           "]],"start1":8144,"start2":8144,"length1":36,"length2":41}]],"length":18483,"saved":false}
{"ts":1355633111610,"patch":[[{"diffs":[[0,"   \r\n        }\r\n"],[1,"        \r\n"],[0,"    }\r\n    \r\n   "]],"start1":9743,"start2":9743,"length1":32,"length2":42}]],"length":18493,"saved":false}
{"ts":1355633119847,"patch":[[{"diffs":[[0,"     }\r\n        "],[1,"return tocItems;"],[0,"\r\n    }\r\n    \r\n "]],"start1":9751,"start2":9751,"length1":32,"length2":48}]],"length":18509,"saved":false}
{"ts":1355633334271,"patch":[[{"diffs":[[0,"ole.log("],[-1,"xml"],[1,"doc"],[0,");\r\n    "]],"start1":7072,"start2":7072,"length1":19,"length2":19}]],"length":18509,"saved":false}
{"ts":1355633337546,"patch":[[{"diffs":[[0,"arseInt("],[-1,"xml"],[1,"doc"],[0,".getElem"]],"start1":7111,"start2":7111,"length1":19,"length2":19}]],"length":18509,"saved":false}
{"ts":1355639583620,"patch":[[{"diffs":[[0,");\r\n"],[-1,"        console.log(this);\r\n"],[0,"    "]],"start1":13523,"start2":13523,"length1":36,"length2":8}]],"length":19291,"saved":false}
{"ts":1355639622273,"patch":[[{"diffs":[[0," function () {\r\n"],[1,"        console.log('getComponents',_opf.spine);'\r\n"],[0,"        return _"]],"start1":17553,"start2":17553,"length1":32,"length2":83}]],"length":19342,"saved":false}
{"ts":1355639635483,"patch":[[{"diffs":[[0,".spine);"],[-1,"'"],[0,"\r\n      "]],"start1":17609,"start2":17609,"length1":17,"length2":16},{"diffs":[[0,"ction () {\r\n"],[1,"        console.log('getContents',_opf.spine);\r\n"],[0,"       retur"]],"start1":17679,"start2":17679,"length1":24,"length2":72}]],"length":19389,"saved":false}
{"ts":1355639642929,"patch":[[{"diffs":[[0,"tContents',_"],[-1,"opf.spine"],[1,"ncx"],[0,");\r\n       r"]],"start1":17714,"start2":17714,"length1":33,"length2":27}]],"length":19383,"saved":false}
{"ts":1355639684255,"patch":[[{"diffs":[[0,"pped file.\r\n"],[1,"        console.log('getComponent',_files[componentId]);\r\n"],[0,"        retu"]],"start1":17930,"start2":17930,"length1":24,"length2":82},{"diffs":[[0,"k;\r\n        "],[1,"}\r\n"],[0,"    "],[-1,"}"],[1,"    return '';\r\n            "],[0,"\r\n    }\r\n   "]],"start1":18570,"start2":18570,"length1":29,"length2":59}]],"length":19471,"saved":false}
{"ts":1355640057997,"patch":[[{"diffs":[[0,"ts',_ncx);\r\n"],[1,"        \r\n        var arr = [];\r\n        \r\n        for(var key in _files){\r\n            arr.push(key);\r\n        }\r\n        \r\n        \r\n"],[0,"       retur"]],"start1":17721,"start2":17721,"length1":24,"length2":159},{"diffs":[[0," return "],[-1,"_ncx"],[1,"arr"],[0,";\r\n    }"]],"start1":17874,"start2":17874,"length1":20,"length2":19}]],"length":19605,"saved":false}
{"ts":1355640130608,"patch":[[{"diffs":[[0,");\r\n"],[-1,"        \r\n        var arr = [];\r\n        \r\n        for(var key in _files){\r\n            arr.push(key);\r\n        }\r\n        \r\n        \r\n"],[0,"    "]],"start1":17729,"start2":17729,"length1":143,"length2":8},{"diffs":[[0,"urn "],[-1,"arr"],[1,"_ncx"],[0,";\r\n "]],"start1":17743,"start2":17743,"length1":11,"length2":12}]],"length":19471,"saved":false}
{"ts":1355640203394,"patch":[[{"diffs":[[0,"opf.spine;\r\n"],[1,"        var arr = [];\r\n        for(var key in _files){\r\n            arr.push(key);\r\n        }\r\n        return arr;\r\n"],[0,"    }\r\n    v"]],"start1":17635,"start2":17635,"length1":24,"length2":140}]],"length":19587,"saved":false}
{"ts":1355640207394,"patch":[[{"diffs":[[0,"n () {\r\n        "],[1,"//"],[0,"console.log('get"]],"start1":17561,"start2":17561,"length1":32,"length2":34},{"diffs":[[0,"pine);\r\n        "],[1,"//"],[0,"return _opf.spin"]],"start1":17613,"start2":17613,"length1":32,"length2":34}]],"length":19591,"saved":false}
{"ts":1355640243388,"patch":[[{"diffs":[[0,"    "],[-1,"arr.push(key);"],[1,"\r\n            if(key){\r\n            arr.push(key);\r\n            }"],[0,"\r\n  "]],"start1":17715,"start2":17715,"length1":22,"length2":73}]],"length":19642,"saved":false}
{"ts":1355640246574,"patch":[[{"diffs":[[0,"        "],[1,"    "],[0,"arr.push"]],"start1":17747,"start2":17747,"length1":16,"length2":20}]],"length":19646,"saved":false}
{"ts":1355640262628,"patch":[[{"diffs":[[0,"    "],[-1,"//console.log('getComponents',_opf.spine);"],[0,"\r\n  "]],"start1":17573,"start2":17573,"length1":50,"length2":8},{"diffs":[[0,"  }\r\n        }\r\n"],[1,"        console.log('getComponents',arr);\r\n"],[0,"        return a"]],"start1":17743,"start2":17743,"length1":32,"length2":75}]],"length":19647,"saved":false}
{"ts":1355640273041,"patch":[[{"diffs":[[0,"ponent',"],[1,"componentId,"],[0,"_files[c"]],"start1":18145,"start2":18145,"length1":16,"length2":28}]],"length":19659,"saved":false}
{"ts":1355640351480,"patch":[[{"diffs":[[0,"    "],[-1,"var arr = [];"],[0,"\r\n  "]],"start1":17613,"start2":17613,"length1":21,"length2":8},{"diffs":[[0,"ey in _files"],[1,".spine"],[0,"){\r\n        "]],"start1":17636,"start2":17636,"length1":24,"length2":30},{"diffs":[[0,"){\r\n            "],[1,"_files.spine[key] = 'OEBPS/Text/' + _files.spine[key];"],[0,"\r\n            if"]],"start1":17654,"start2":17654,"length1":32,"length2":86}]],"length":19706,"saved":false}
{"ts":1355640376648,"patch":[[{"diffs":[[0,"    "],[-1,"if(key){\r\n                arr.push(key);\r\n            }"],[0,"\r\n  "]],"start1":17734,"start2":17734,"length1":63,"length2":8},{"diffs":[[0,"onents',"],[-1,"arr"],[1,"_files.spine"],[0,");\r\n    "]],"start1":17779,"start2":17779,"length1":19,"length2":28},{"diffs":[[0,"urn "],[-1,"arr"],[1,"_files.spine"],[0,";\r\n "]],"start1":17814,"start2":17814,"length1":11,"length2":20}]],"length":19669,"saved":false}
{"ts":1355640522878,"patch":[[{"diffs":[[0,"    "],[-1,"for(var key in _files.spine){\r\n            _files.spine[key] = 'OEBPS/Text/' + _files.spine[key];\r\n            \r\n        }"],[0,"\r\n  "]],"start1":17623,"start2":17623,"length1":130,"length2":8}]],"length":19547,"saved":false}
{"ts":1355640544204,"patch":[[{"diffs":[[0," var _ncx;\r\n"],[1,"    var _oebpsDir\r\n"],[0,"    ////////"]],"start1":1075,"start2":1075,"length1":24,"length2":43}]],"length":19566,"saved":false}
{"ts":1355640546454,"patch":[[{"diffs":[[0,"oebpsDir"],[1," = '';"],[0,"\r\n    //"]],"start1":1096,"start2":1096,"length1":16,"length2":22}]],"length":19572,"saved":false}
{"ts":1355640622173,"patch":[[{"diffs":[[0,"ntainer();\r\n"],[1,"            \r\n            // Get the OEPBS dir, if there is one\r\n            if (_opfPath.indexOf('/') != -1) {\r\n                _oebpsDir =  opf_file.substr(0, opf_file.lastIndexOf('/'));\r\n            }\r\n            \r\n"],[0,"            "]],"start1":4352,"start2":4352,"length1":24,"length2":243}]],"length":19791,"saved":false}
{"ts":1355640628593,"patch":[[{"diffs":[[0,"sDir =  "],[1,"_"],[0,"opf"],[-1,"_file"],[1,"Path"],[0,".substr("]],"start1":4498,"start2":4498,"length1":24,"length2":24},{"diffs":[[0,"(0, "],[1,"_"],[0,"opf"],[-1,"_file"],[1,"Path"],[0,".las"]],"start1":4521,"start2":4521,"length1":16,"length2":16}]],"length":19791,"saved":false}
{"ts":1355640864447,"patch":[[{"diffs":[[0,"ne.push("],[1,"(_oebpsDir ? _oebpsDir+ '/' : '') + "],[0,"node.get"]],"start1":7212,"start2":7212,"length1":16,"length2":52}]],"length":19827,"saved":false}
{"ts":1355640909033,"patch":[[{"diffs":[[0,"nents',_"],[-1,"files"],[1,"opf"],[0,".spine);"]],"start1":17938,"start2":17938,"length1":21,"length2":19}]],"length":19825,"saved":false}
{"ts":1355640964880,"patch":[[{"diffs":[[0,"rn _ncx;},\r\n"],[1,"        oebpsDir:           function(){return _oebpsDir;},\r\n"],[0,"        publ"]],"start1":19540,"start2":19540,"length1":24,"length2":84}]],"length":19885,"saved":false}
{"ts":1355641010648,"patch":[[{"diffs":[[0,"return _"],[-1,"files"],[1,"opf"],[0,".spine;\r"]],"start1":17967,"start2":17967,"length1":21,"length2":19}]],"length":19883,"saved":false}
{"contributors":[],"silentsave":false,"ts":1355641135530,"patch":[[{"diffs":[[0,"ode."],[-1,"children[0]"],[1,"firstElementChild"],[0,";\r\n "]],"start1":8205,"start2":8205,"length1":19,"length2":25},{"diffs":[[0,"lement.child"],[-1,"ren"],[1,"Nodes"],[0,".length; ii "]],"start1":8288,"start2":8288,"length1":27,"length2":29},{"diffs":[[0,"lement.child"],[-1,"ren[ii];"],[1,"Nodes[ii];\r\n                    if(liElement.nodeName.toLowerCase() != \"li\"){\r\n                        continue;\r\n                    }"],[0,"\r\n          "]],"start1":8372,"start2":8372,"length1":32,"length2":159},{"diffs":[[0,"  .child"],[-1,"ren"],[1,"Nodes"],[0,";\r\n\t\t\r\n "]],"start1":9525,"start2":9525,"length1":19,"length2":21},{"diffs":[[0,"intElement.child"],[-1,"ren"],[1,"Nodes"],[0,";\r\n        \r\n   "]],"start1":10303,"start2":10303,"length1":35,"length2":37},{"diffs":[[0,"n.push(recursive"],[-1,""],[1,"2"],[0,"NcxParser(childN"]],"start1":10796,"start2":10796,"length1":32,"length2":33},{"diffs":[[0," liElement.child"],[-1,"ren"],[1,"Nodes"],[0,";\r\n        \r\n   "]],"start1":10975,"start2":10975,"length1":35,"length2":37},{"diffs":[[0,"    "],[-1,"tocItem.push(recursiveNcxParser(childNavPoint));"],[0,"\r\n  "]],"start1":11302,"start2":11302,"length1":56,"length2":8},{"diffs":[[0," link = "],[-1,"liATag"],[1,"childElement"],[0,".getAttr"]],"start1":11327,"start2":11327,"length1":22,"length2":28},{"diffs":[[0,"e = "],[-1,"liATag.text;\r\n"],[1,"childElement.text;\r\n        "],[0,"    "]],"start1":11395,"start2":11395,"length1":22,"length2":36},{"diffs":[[0,"lChild))"],[-1,"  "],[1,";"],[0,"        "]],"start1":11837,"start2":11837,"length1":18,"length2":17},{"diffs":[[0,"ction () {\r\n    "],[1,"    \r\n        //return _opf.spine;\r\n        \r\n        \r\n        console.log('getComponents',_opf.spine);\r\n        return _opf.spine;"],[0,"\r\n    }\r\n    var"]],"start1":17837,"start2":17837,"length1":32,"length2":164},{"diffs":[[0,"n () {\r\n        "],[-1,"//"],[0,"console.log('get"]],"start1":18023,"start2":18023,"length1":34,"length2":32},{"diffs":[[0,"\n       "],[-1," "],[1,"return _ncx;"],[0,"\r\n    "],[1,"}\r\n"],[0,"    "],[-1,"\r\n        "],[1,"var getComponent = function (componentId, callback) {\r\n        //todo: decide if it would be better/faster to unzip the file on demand. for now just display the unzipped file."],[0,"\r\n      "]],"start1":18072,"start2":18072,"length1":37,"length2":216},{"diffs":[[0,"nent"],[-1,"s"],[0,"',"],[-1,"_opf.spine);\r\n        return _opf.spine;\r\n       "],[1,"componentId,_files[componentId]);\r\n        return _files[componentId];"],[0,"\r\n  "]],"start1":18311,"start2":18311,"length1":60,"length2":80},{"diffs":[[0,"\n    var get"],[-1,"Component"],[1,"MetaData"],[0," = function "]],"start1":18395,"start2":18395,"length1":33,"length2":32},{"diffs":[[0,"tion"],[-1," (componentId) {\r\n    \r\n    }\r\n    var getMetaData = function(key) {\r\n    \r\n    }\r\n    \r\n    return _ncx"],[1,"(key) {\r\n        switch (key) {\r\n            case \"title\":\r\n                try{\r\n                    return _opf.metadata['dc:title']._text;\r\n                }\r\n                catch(ex){\r\n                    return '';\r\n                }\r\n                break;\r\n            case \"creator\":\r\n                try{\r\n                    return _opf.metadata['dc:creator']._text\r\n                }\r\n                catch(ex){\r\n                    return '';\r\n                }\r\n                break;\r\n        }\r\n        return '';\r\n            \r\n    }\r\n    \r\n    return "],[0,"{\r\n "]],"start1":18422,"start2":18422,"length1":112,"length2":577},{"diffs":[[0,"    "],[-1,"console.log('getComponent',componentId,_files[componentId]);\r\n        "],[1,""],[0," fun"]],"start1":19226,"start2":19226,"length1":78,"length2":8},{"diffs":[[0," }\r\n"],[-1,"    }\r\n       return '';\r\n    "],[0,"    "]],"start1":19851,"start2":19851,"length1":38,"length2":8}]],"length":19883,"saved":false}
{"ts":1355641636235,"patch":[[{"diffs":[[0,"    "],[-1,"//return _opf.spine"],[1,"var componentArr = [];\r\n        for(var key in _opf.spine){\r\n            var spineEntry = _opf.spine[key];\r\n            componentArr.push(_opf.manifest[spineEntry].href)"],[0,";\r\n "]],"start1":17863,"start2":17863,"length1":27,"length2":177},{"diffs":[[0,"href);\r\n        "],[1,"}"],[0,"\r\n        \r\n    "]],"start1":18031,"start2":18031,"length1":32,"length2":33}]],"length":20034,"saved":false}
{"ts":1355641643817,"patch":[[{"diffs":[[0,"onents',"],[-1,"_opf.spine"],[1,"componentArr"],[0,");\r\n    "]],"start1":18088,"start2":18088,"length1":26,"length2":28},{"diffs":[[0," return "],[-1,"_opf.spine"],[1,"componentArr"],[0,";\r\n    }"]],"start1":18119,"start2":18119,"length1":26,"length2":28}]],"length":20038,"saved":false}
{"ts":1355642737065,"patch":[[{"diffs":[[0,"     return "],[1,"'<div>this is a test content fcil sbal sdfjklasjdfklajsdklfjaskjld asjkdfljsadfk ljaskld klsadj fkljsadk fljaslk jskldj k jslkasjkf </div>'//"],[0,"_files[compo"]],"start1":18510,"start2":18510,"length1":24,"length2":165}]],"length":20179,"saved":false}
{"ts":1355642959807,"patch":[[{"diffs":[[0,"urn "],[-1,"'<div>this is a test content fcil sbal sdfjklasjdfklajsdklfjaskjld asjkdfljsadfk ljaskld klsadj fkljsadk fljaslk jskldj k jslkasjkf </div>'//"],[0,"_fil"]],"start1":18518,"start2":18518,"length1":149,"length2":8},{"diffs":[[0,"onentId]"],[1,".outerHTML"],[0,";\r\n    }"]],"start1":18533,"start2":18533,"length1":16,"length2":26}]],"length":20048,"saved":false}
{"ts":1355643014890,"patch":[[{"diffs":[[0,"onentId]"],[1,".body.outerHTML"],[0,");\r\n    "]],"start1":18495,"start2":18495,"length1":16,"length2":31},{"diffs":[[0,"nentId]."],[1,"body."],[0,"outerHTM"]],"start1":18549,"start2":18549,"length1":16,"length2":21}]],"length":20068,"saved":false}
{"contributors":[],"silentsave":false,"ts":1355685098816,"patch":[[{"diffs":[[0,".6.0\")\r\n"],[-1,"\t"],[1,"    "],[0,"\t\t\t: new"]],"start1":1813,"start2":1813,"length1":17,"length2":20},{"diffs":[[0,"es[componentId]."],[-1,"body."],[0,"outerHTML;\r\n    "]],"start1":18544,"start2":18544,"length1":37,"length2":32}]],"length":20066,"saved":false}
{"ts":1355685161091,"patch":[[{"diffs":[[0,"nentId]."],[1,"body."],[0,"outerHTM"]],"start1":18552,"start2":18552,"length1":16,"length2":21}]],"length":20071,"saved":false}
{"ts":1355685205728,"patch":[[{"diffs":[[0,"omponentId]."],[-1,"body.out"],[1,"inn"],[0,"erHTML);\r\n  "]],"start1":18495,"start2":18495,"length1":32,"length2":27},{"diffs":[[0,"Id]."],[-1,"body.out"],[1,"inn"],[0,"erHT"]],"start1":18551,"start2":18551,"length1":16,"length2":11}]],"length":20061,"saved":false}
{"ts":1355685521835,"patch":[[{"diffs":[[0,"Id]."],[-1,"innerHTML);"],[1,"documentElement.outerHTML);\r\n        \r\n        "],[0,"\r\n  "]],"start1":18503,"start2":18503,"length1":19,"length2":55},{"diffs":[[0,"Id]."],[-1,"inn"],[1,"documentElement.out"],[0,"erHT"]],"start1":18587,"start2":18587,"length1":11,"length2":27}]],"length":20113,"saved":false}
{"ts":1355688313659,"patch":[[{"diffs":[[0,"xt\")[0]."],[-1,"text"],[1,"value"],[0,";\r\n     "]],"start1":10492,"start2":10492,"length1":20,"length2":21}]],"length":20114,"saved":false}
{"ts":1355688327380,"patch":[[{"diffs":[[0,"Element."],[-1,"text"],[1,"value"],[0,";\r\n     "]],"start1":11408,"start2":11408,"length1":20,"length2":21}]],"length":20115,"saved":false}
{"ts":1355688748099,"patch":[[{"diffs":[[0,"me(\""],[-1,"text\")[0].value"],[1,"navLabel\")[0].getElementsByTagName(\"text\")[0].textContent"],[0,";\r\n "]],"start1":10486,"start2":10486,"length1":23,"length2":65}]],"length":20157,"saved":false}
{"ts":1355689661766,"patch":[[{"diffs":[[0,"ush("],[-1,"(_oebpsDir ? _oebpsDir+ '/' : '')"],[0," + n"]],"start1":7219,"start2":7219,"length1":41,"length2":8},{"diffs":[[0," \r\n    }\r\n    \r\n"],[1,"    function getOepbsDir(){\r\n        return (_oebpsDir ? _oebpsDir+ '/' : '')\r\n    }\r\n    \r\n"],[0,"    function rea"]],"start1":7525,"start2":7525,"length1":32,"length2":124}]],"length":20216,"saved":false}
{"ts":1355689663624,"patch":[[{"diffs":[[0,"/' : '')"],[1,";"],[0,"\r\n    }\r"]],"start1":7610,"start2":7610,"length1":16,"length2":17}]],"length":20217,"saved":false}
{"ts":1355689671325,"patch":[[{"diffs":[[0,"ne.push("],[1,"getOepbsDir()"],[0," + node."]],"start1":7215,"start2":7215,"length1":16,"length2":29}]],"length":20230,"saved":false}
{"ts":1355689688378,"patch":[[{"diffs":[[0,"(_files["],[1,"getOepbsDir() +"],[0,"ncxFile]"]],"start1":7500,"start2":7500,"length1":16,"length2":31}]],"length":20245,"saved":false}
{"ts":1355689689506,"patch":[[{"diffs":[[0,"sDir() +"],[1," "],[0,"ncxFile]"]],"start1":7515,"start2":7515,"length1":16,"length2":17}]],"length":20246,"saved":false}
{"ts":1355689824796,"patch":[[{"diffs":[[0,"ne.push("],[-1,"getOepbsDir("],[1,"(_oebpsDir ? _oebpsDir+ '/' : ''"],[0,") + node"]],"start1":7215,"start2":7215,"length1":28,"length2":48},{"diffs":[[0,"les["],[-1,"getOepbsDir() + "],[0,"ncxF"]],"start1":7524,"start2":7524,"length1":24,"length2":8},{"diffs":[[0,"  \r\n"],[-1,"    function getOepbsDir(){\r\n        return (_oebpsDir ? _oebpsDir+ '/' : '');\r\n    }\r\n    \r\n"],[0,"    "]],"start1":7570,"start2":7570,"length1":101,"length2":8}]],"length":20157,"saved":false}
{"ts":1355689903607,"patch":[[{"diffs":[[0," \r\n    }\r\n    \r\n"],[1,"    \r\n    function getOepbsDir(){\r\n        return (_oebpsDir ? _oebpsDir+ '/' : '')\r\n    }\r\n    \r\n"],[0,"    function rea"]],"start1":7558,"start2":7558,"length1":32,"length2":130}]],"length":20255,"saved":false}
{"ts":1355689910541,"patch":[[{"diffs":[[0,"ush("],[-1,"(_oebpsDir ? _oebpsDir+ '/' : ''"],[1,"getOepbsDir("],[0,") + "]],"start1":7219,"start2":7219,"length1":40,"length2":20}]],"length":20235,"saved":false}
{"ts":1355689956789,"patch":[[{"diffs":[[0,".log(doc"],[1,", ncxFile"],[0,");\r\n    "]],"start1":7338,"start2":7338,"length1":16,"length2":25}]],"length":20244,"saved":false}
{"ts":1355690100256,"patch":[[{"diffs":[[0,"ush("],[-1,"getOepbsDir() + "],[0,"node"]],"start1":7219,"start2":7219,"length1":24,"length2":8}]],"length":20228,"saved":false}
{"ts":1355690306713,"patch":[[{"diffs":[[0,"  \r\n"],[-1,"    \r\n    function getOepbsDir(){\r\n        return (_oebpsDir ? _oebpsDir+ '/' : '')\r\n    }\r\n    \r\n"],[0,"    "]],"start1":7543,"start2":7543,"length1":106,"length2":8},{"diffs":[[0,"des;\r\n        \r\n"],[1,"        \r\n        \r\n"],[0,"        var link"]],"start1":10297,"start2":10297,"length1":32,"length2":52}]],"length":20150,"saved":false}
{"ts":1355690344732,"patch":[[{"diffs":[[0,"(_files["],[-1,"ncxFile"],[1,"resolvePath(ncxFile, _opfPath)"],[0,"]);\r\n   "]],"start1":7493,"start2":7493,"length1":23,"length2":46}]],"length":20173,"saved":false}
{"ts":1355690469772,"patch":[[{"diffs":[[0," link = "],[1,"resolvePath("],[0,"navPoint"]],"start1":10367,"start2":10367,"length1":16,"length2":28},{"diffs":[[0,"Attribute(\"src\")"],[1,", _opfPath)"],[0,";\r\n        var t"]],"start1":10441,"start2":10441,"length1":32,"length2":43}]],"length":20196,"saved":false}
{"ts":1355690569937,"patch":[[{"diffs":[[0,"(event, "],[-1,"["],[0,"state, m"]],"start1":17473,"start2":17473,"length1":17,"length2":16},{"diffs":[[0," message"],[-1,"]"],[0,");\r\n    "]],"start1":17487,"start2":17487,"length1":17,"length2":16}]],"length":20194,"saved":false}
{"ts":1355691668409,"patch":[[{"diffs":[[0,"ef))\r\n        }\r"],[1,"\n        \r\n        var svgImages = doc.getElementsByTagName(\"img\");\r\n        for (var i = 0, il = images.length; i < il; i++) {\r\n            var image = images[i];\r\n            var src = image.getAttribute(\"src\");\r\n            if (/^data/.test(src)) { \r\n                continue;\r\n            }\r\n            image.setAttribute(\"src\", getDataUri(src, href))\r\n        }\r\n        \r"],[0,"\n\r\n        var h"]],"start1":14861,"start2":14861,"length1":32,"length2":410}]],"length":20572,"saved":false}
{"ts":1355691671171,"patch":[[{"diffs":[[0,"ntsByTagName(\"im"],[-1,"g"],[1,"ages"],[0,"\");\r\n        for"]],"start1":14924,"start2":14924,"length1":33,"length2":36}]],"length":20575,"saved":false}
{"ts":1355691726911,"patch":[[{"diffs":[[0,"e(\"image"],[-1,"s"],[0,"\");\r\n   "]],"start1":14935,"start2":14935,"length1":17,"length2":16}]],"length":20574,"saved":false}
{"ts":1355691762516,"patch":[[{"diffs":[[0,"e.getAttribute(\""],[-1,"src"],[1,"href"],[0,"\");\r\n           "]],"start1":15070,"start2":15070,"length1":35,"length2":36}]],"length":20575,"saved":false}
{"ts":1355691885424,"patch":[[{"diffs":[[0,"\n            }\r\n"],[1,"            var newImgNode=xmlDoc.createElement(\"book\");\r\n            \r\n"],[0,"            imag"]],"start1":15160,"start2":15160,"length1":32,"length2":104}]],"length":20647,"saved":false}
{"ts":1355691928991,"patch":[[{"diffs":[[0,"ImgNode="],[-1,"xmlD"],[1," d"],[0,"oc.creat"]],"start1":15195,"start2":15195,"length1":20,"length2":18}]],"length":20645,"saved":false}
{"ts":1355691977568,"patch":[[{"diffs":[[0,"nt(\""],[-1,"book\""],[1,"img\");\r\n            newImgNode.setAttribute('src', 'http://www.testtrackinglink.com');\r\n            newImgNode.setAttribute('alt', 'na');\r\n            newImgNode.setAttribute('height', '1px');\r\n            newImgNode.setAttribute('width', '1px'"],[0,");\r\n"]],"start1":15219,"start2":15219,"length1":13,"length2":252}]],"length":20884,"saved":false}
{"ts":1355692002879,"patch":[[{"diffs":[[0,"\n            }\r\n"],[1,"            //create a newnode.\r\n"],[0,"            var "]],"start1":15160,"start2":15160,"length1":32,"length2":65},{"diffs":[[0,"ute("],[-1,"'src', 'http://www.testtrackinglink.com');"],[1,"\"src\", getDataUri(src, href))"],[0,"\r\n  "]],"start1":15296,"start2":15296,"length1":50,"length2":37},{"diffs":[[0,"    "],[-1,"image.setAttribute(\"src\", getDataUri(src, href))"],[1,"//replace node.\r\n            image"],[0,"\r\n  "]],"start1":15513,"start2":15513,"length1":56,"length2":42}]],"length":20890,"saved":false}
{"ts":1355692008617,"patch":[[{"diffs":[[0,"))\r\n"],[-1,"            newImgNode.setAttribute('alt', 'na');\r\n"],[0,"    "]],"start1":15327,"start2":15327,"length1":59,"length2":8}]],"length":20839,"saved":false}
{"ts":1355692054992,"patch":[[{"diffs":[[0,"a newnode.\r\n"],[1,"            var height = \r\n"],[0,"            "]],"start1":15197,"start2":15197,"length1":24,"length2":51},{"diffs":[[0,"ode."],[-1,"setAttribute('height', '1px');\r\n            newImgNode.setAttribute('width', '1px')"],[1,"height = image.height;\r\n            newImgNode.width = image.width"],[0,";\r\n "]],"start1":15377,"start2":15377,"length1":91,"length2":74}]],"length":20849,"saved":false}
{"ts":1355692064936,"patch":[[{"diffs":[[0,"aUri(src, href))"],[1,";"],[0,"\r\n            ne"]],"start1":15340,"start2":15340,"length1":32,"length2":33}]],"length":20850,"saved":false}
{"ts":1355692070843,"patch":[[{"diffs":[[0,"e.\r\n"],[-1,"            var height = \r\n"],[0,"    "]],"start1":15205,"start2":15205,"length1":35,"length2":8}]],"length":20823,"saved":false}
{"ts":1355692186279,"patch":[[{"diffs":[[0,"   image"],[1,".parentNode.replaceChild(newImgNode, image);\r\n            "],[0,"\r\n      "]],"start1":15476,"start2":15476,"length1":16,"length2":74}]],"length":20881,"saved":false}
{"ts":1355692406235,"patch":[[{"diffs":[[0,"var i = 0, il = "],[-1,"i"],[1,"svgI"],[0,"mages.length; i "]],"start1":14961,"start2":14961,"length1":33,"length2":36},{"diffs":[[0,"    var image = "],[-1,"i"],[1,"svgI"],[0,"mages[i];\r\n     "]],"start1":15019,"start2":15019,"length1":33,"length2":36}]],"length":20887,"saved":false}
{"ts":1355692707862,"patch":[[{"diffs":[[0,"ibute(\"href\");\r\n"],[1,"            if(!src){\r\n                continue;\r\n            }\r\n"],[0,"            if ("]],"start1":15085,"start2":15085,"length1":32,"length2":97}]],"length":20952,"saved":false}
{"ts":1355692849599,"patch":[[{"diffs":[[0,"      var src = "],[1,"("],[0,"image.getAttribu"]],"start1":15056,"start2":15056,"length1":32,"length2":33},{"diffs":[[0,"ttribute(\"href\")"],[1," : image.getAttribute(\"href\") ? image.getAttributeNS(\"http://www.w3.org/1999/xlink\",\"href\"))"],[0,";\r\n            i"]],"start1":15083,"start2":15083,"length1":32,"length2":124}]],"length":21045,"saved":false}
{"ts":1355692860651,"patch":[[{"diffs":[[0,"\"href\") "],[-1,":"],[1,"?"],[0," image.g"]],"start1":15092,"start2":15092,"length1":17,"length2":17},{"diffs":[[0,"tribute(\"href\") "],[-1,"?"],[1,":"],[0," image.getAttrib"]],"start1":15113,"start2":15113,"length1":33,"length2":33}]],"length":21045,"saved":false}
{"ts":1355694244737,"patch":[[{"diffs":[[0,"r result"],[1," = ''"],[0,";\r\n\r\n   "]],"start1":13432,"start2":13432,"length1":16,"length2":21}]],"length":21050,"saved":false}
{"ts":1355694301597,"patch":[[{"diffs":[[0,"sult"],[-1," !== undefined"],[0,") {\r"]],"start1":13692,"start2":13692,"length1":22,"length2":8}]],"length":21036,"saved":false}
{"ts":1355694325528,"patch":[[{"diffs":[[0,"\n            }\r\n"],[1,"            //only change the current file stored in _files if result is defined."],[0,"\r\n            if"]],"start1":13656,"start2":13656,"length1":32,"length2":113}]],"length":21117,"saved":false}
{"ts":1355696169736,"patch":[[{"diffs":[[0,"\t\t}\r\n\t\t}"],[1,";"],[0,"\r\n"],[-1,""],[0,"\t\treques"]],"start1":2548,"start2":2548,"length1":18,"length2":19},{"diffs":[[0,"edFile()"],[1,";"],[0,"\r\n      "]],"start1":3452,"start2":3452,"length1":16,"length2":17},{"diffs":[[0,"    }\r\n    }"],[-1,";"],[0,"\r\n        \r\n"]],"start1":4014,"start2":4014,"length1":25,"length2":24},{"diffs":[[0," 30);\r\n    }"],[-1,";"],[0,"\r\n\r\n    func"]],"start1":4196,"start2":4196,"length1":25,"length2":24},{"diffs":[[0,")\r\n            }"],[1,";"],[0,"\r\n        }\r\n\r\n "]],"start1":6930,"start2":6930,"length1":32,"length2":33},{"diffs":[[0,", href))"],[1,";"],[0,"\r\n      "]],"start1":14930,"start2":14930,"length1":16,"length2":17},{"diffs":[[0,"onentArr;\r\n    }"],[1,";"],[0,"\r\n    var getCon"]],"start1":19140,"start2":19140,"length1":32,"length2":33},{"diffs":[[0,"urn _ncx;\r\n    }"],[1,";"],[0,"\r\n    var getCom"]],"start1":19248,"start2":19248,"length1":32,"length2":33},{"diffs":[[0,"HTML;\r\n    }"],[1,";"],[0,"\r\n    var ge"]],"start1":19620,"start2":19620,"length1":24,"length2":25},{"diffs":[[0,"']._text"],[1,";"],[0,"\r\n      "]],"start1":20033,"start2":20033,"length1":16,"length2":17},{"diffs":[[0,"         \r\n    }"],[1,";"],[0,"\r\n    \r\n    retu"]],"start1":20200,"start2":20200,"length1":32,"length2":33},{"diffs":[[0,"taData\r\n"],[-1,""],[0,"    }"],[1,";"],[0,"\r\n      "]],"start1":21081,"start2":21081,"length1":21,"length2":22}]],"length":21125,"saved":false}
{"ts":1355699728112,"patch":[[{"diffs":[[0,"   $"],[-1,"(window).trigger"],[1,".publish"],[0,"(eve"]],"start1":18378,"start2":18378,"length1":24,"length2":16}]],"length":21117,"saved":false}
{"ts":1355699733991,"patch":[[{"diffs":[[0,".publish(event, "],[1,"["],[0,"state, message);"]],"start1":18382,"start2":18382,"length1":32,"length2":33},{"diffs":[[0," message"],[1,"]"],[0,");\r\n    "]],"start1":18405,"start2":18405,"length1":16,"length2":17}]],"length":21119,"saved":false}
{"ts":1355699737427,"patch":[[{"diffs":[[0,"    "],[-1,"function subscribe(selector, event, handler){\r\n        $(selector).bind(event, handler);\r\n    }"],[0,"\r\n  "]],"start1":18425,"start2":18425,"length1":103,"length2":8}]],"length":21024,"saved":false}
{"ts":1355700257930,"patch":[[{"diffs":[[0,"_READY, "],[-1,"this"],[1,"STATE.OK,MSG.FINISHED_POST_PROCESSING"],[0,");\r\n    "]],"start1":13950,"start2":13950,"length1":20,"length2":53}]],"length":21057,"saved":false}
{"ts":1355700383090,"patch":[[{"diffs":[[0,"ING = 'F"],[-1,"INISHED_POST_PROCESSING"],[1,"inished Post processing';\r\n    \r\n    MSG.INIT_EBOOK_READER = 'Initializing Ebook Reader"],[0,"';\r\n    "]],"start1":684,"start2":684,"length1":39,"length2":103}]],"length":21121,"saved":false}
{"ts":1355700429802,"patch":[[{"diffs":[[0,"MSG."],[-1,"F"],[0,"INI"],[-1,"SHED_POST_PROCESSING"],[1,"T_EBOOK_READER"],[0,");\r\n"]],"start1":14031,"start2":14031,"length1":32,"length2":25}]],"length":21114,"saved":false}
{"ts":1355700549957,"patch":[[{"diffs":[[0,"LOADING,"],[1," "],[0,"STATE.OK"]],"start1":13935,"start2":13935,"length1":16,"length2":17},{"diffs":[[0,"G, STATE.OK,"],[1," "],[0,"MSG.FINISHED"]],"start1":13941,"start2":13941,"length1":24,"length2":25}]],"length":21116,"saved":false}
{"ts":1355700589323,"patch":[[{"diffs":[[0,"DING, STATE.ERR,"],[1," "],[0,"MSG.ERR_BLANK_UR"]],"start1":18145,"start2":18145,"length1":32,"length2":33}]],"length":21117,"saved":false}
{"ts":1355700988638,"patch":[[{"diffs":[[0,");\r\n"],[-1,"            publish(EVENT.LOADING, STATE.OK, MSG.FINISHED);\r\n"],[0,"    "]],"start1":4784,"start2":4784,"length1":69,"length2":8}]],"length":21056,"saved":false}
{"ts":1355701035565,"patch":[[{"diffs":[[0," }\r\n"],[-1,"        publish(EVENT.LOADING, STATE.OK, MSG.FINISHED_POST_PROCESSING);\r\n"],[0,"    "]],"start1":13848,"start2":13848,"length1":81,"length2":8}]],"length":20983,"saved":false}
